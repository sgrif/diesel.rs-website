<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <link rel="icon" type="image/png" href="/assets/images/diesel_logo_favicon_32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/assets/images/diesel_logo_favicon_96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/assets/images/diesel_logo_favicon.png" sizes="192x192">
  <title>Getting Started with Diesel</title>
  <style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { color: #de935f; } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #de935f; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #81a2be; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #b5bd68; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */
  </style>
  <link rel="stylesheet" href="../assets/stylesheets/application.css">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
    <header class="main-header">
        <div class="content-wrapper">
            <h1>
                <a href="/" aria-label="Diesel Home Page">
                    <svg class='logo' height='76px' version='1.1' viewBox='0 0 187 76' width='187px' xmlns:sketch='http://www.bohemiancoding.com/sketch/ns' xmlns:xlink='http://www.w3.org/1999/xlink' xmlns='http://www.w3.org/2000/svg'>
<g fill-rule='evenodd' fill='none' id='Page-1' sketch:type='MSPage' stroke-width='1' stroke='none'>
<g id='Desktop-HD' sketch:type='MSArtboardGroup' transform='translate(-119.000000, -30.000000)'>
<g id='logo' sketch:type='MSLayerGroup' transform='translate(119.000000, 31.000000)'>
<g id='mark' sketch:type='MSShapeGroup' transform='translate(0.130247, 0.315216)'>
<g id='drop' transform='translate(73.929204, 47.710843)'>
<path d='M9.7807837,7.73987977 C9.7807837,10.2104926 7.78625402,12.2130607 5.3255584,12.2130607 C2.86486278,12.2130607 0.870333101,10.2104926 0.870333101,7.73987977 C0.870333101,5.26926692 5.3255584,0.395873804 5.3255584,0.395873804 C5.3255584,0.395873804 9.7807837,5.26926692 9.7807837,7.73987977' fill='#FDBD41' id='drop-fill'></path>
<path d='M9.7807837,7.73987977 C9.7807837,10.2104926 7.78625402,12.2130607 5.3255584,12.2130607 C2.86486278,12.2130607 0.870333101,10.2104926 0.870333101,7.73987977 C0.870333101,5.26926692 5.3255584,0.395873804 5.3255584,0.395873804 C5.3255584,0.395873804 9.7807837,5.26926692 9.7807837,7.73987977 L9.7807837,7.73987977 Z' id='drop-stroke' stroke-width='2.235' stroke='#000000'></path>
</g>
<g id='can'>
<path d='M79.275823,44.6326234 L80.2209163,43.6799527 C80.6090126,43.2880312 80.6090126,42.6541735 80.219415,42.2637594 L74.2643514,36.3027842 C74.0774346,36.1143604 73.8229575,36.0299465 73.5579711,36.0299465 L64.1791025,36.0299465 L64.1791025,39.0447273 L72.1842454,39.0447273 C72.4499825,39.0447273 72.7044595,39.2934467 72.892127,39.4826242 L77.8608104,44.5617761 C78.2511587,44.9544513 78.8854747,45.0260523 79.275823,44.6326234' fill='#FFFFFF' id='nozzle-fill'></path>
<path d='M79.275823,44.6326234 L80.2209163,43.6799527 C80.6090126,43.2880312 80.6090126,42.6541735 80.219415,42.2637594 L74.2643514,36.3027842 C74.0774346,36.1143604 73.8229575,36.0299465 73.5579711,36.0299465 L64.1791025,36.0299465 L64.1791025,39.0447273 L72.1842454,39.0447273 C72.4499825,39.0447273 72.7044595,39.2934467 72.892127,39.4826242 L77.8608104,44.5617761 C78.2511587,44.9544513 78.8854747,45.0260523 79.275823,44.6326234 L79.275823,44.6326234 Z' id='nozzle-stroke' stroke-width='2' stroke='#000000'></path>
<path d='M62.9549102,43.5800881 L63.0967868,31.4757433 L66.1257395,32.9755967 C66.3952299,33.123321 66.5626293,33.4082178 66.5596266,33.7164791 L66.495069,41.2926232 C66.4920663,41.6016382 66.320163,41.8835202 66.0476698,42.0259686 L62.9549102,43.5800881 Z' fill='#9B9B9B' id='attachement-fill'></path>
<path d='M62.9549102,43.5800881 L63.0967868,31.4757433 L66.1257395,32.9755967 C66.3952299,33.123321 66.5626293,33.4082178 66.5596266,33.7164791 L66.495069,41.2926232 C66.4920663,41.6016382 66.320163,41.8835202 66.0476698,42.0259686 L62.9549102,43.5800881 L62.9549102,43.5800881 Z' id='attachment-stroke' stroke-width='2.235' stroke='#000000'></path>
<path d='M57.3441789,25.3100644 C56.3690588,26.2891144 54.5156551,26.2793164 53.5232696,25.2829314 L38.2891765,9.98744111 C37.2967911,8.99105607 37.3838688,7.22665562 38.3582382,6.24760556 L38.5271389,6.07802415 C39.5022589,5.09972779 41.0936789,5.17886578 42.0860644,6.17525083 L57.3201575,21.4707411 C58.3125429,22.4671261 58.4881997,24.1614329 57.5130796,25.140483 L57.3441789,25.3100644 Z M62.9742024,45.1367701 L63.179886,22.3812049 C63.1783846,21.6380614 62.9066422,20.8843662 62.384176,20.3590407 L43.748798,1.64931119 C41.7662791,-0.341197814 38.467836,-0.295222407 36.485317,1.6952866 L2.35686493,35.9612849 C0.373595307,37.9517939 0.591289551,40.9997372 2.57380851,42.9902462 L30.81776,71.3480279 C32.8002789,73.3385369 35.853253,73.5744435 37.835772,71.5839345 L62.1732378,47.1483826 C62.6994573,46.6200423 62.9764544,45.8844358 62.9742024,45.1367701 L62.9742024,45.1367701 Z' fill='#FF2727' id='red-fill'></path>
<path d='M62.8151162,44.3834657 L62.8670115,37.9165376 L36.2319575,64.7024784 C35.0391186,65.9020746 33.1054561,65.9020746 31.9126172,64.7024784 L2.35413024,34.9765434 L2.1187213,35.213286 C0.107591965,37.2350519 0.107591965,40.5441526 2.1187213,42.5659185 L30.2985994,70.9054348 C32.3089767,72.9279572 35.599437,72.9279572 37.6098142,70.9054348 L61.9938173,46.3832971 C62.5210431,45.8530846 62.8166204,45.1337807 62.8151162,44.3834657' fill='#9B0000' id='shadow'></path>
<path d='M57.4628598,25.4292236 C56.4877397,26.4082737 54.5149795,26.2793918 53.522594,25.2830067 L38.2885009,9.98676279 C37.2961155,8.99037774 37.5025496,7.34581483 38.4769191,6.36676477 L38.6458198,6.19718336 C39.6209398,5.218887 41.0930033,5.17818745 42.0853888,6.1745725 L57.3202325,21.4700627 C58.312618,22.4664478 58.6068806,24.2805921 57.6317605,25.2596422 L57.4628598,25.4292236 L57.4628598,25.4292236 Z M63.1199074,22.4400685 C63.1184061,21.6976787 62.7881114,21.0027717 62.2648945,20.4781999 L43.6295166,1.76771671 C41.6469976,-0.222792299 38.5865168,-0.176063197 36.6039979,1.81444581 L2.47554583,36.0804441 C0.492276204,38.0709531 0.472008119,41.1181427 2.45452708,43.1086517 L30.6984785,71.4671871 C32.6809975,73.4576961 35.8533281,73.5745188 37.835847,71.5840098 L62.1733128,47.148458 C62.6995324,46.6201176 62.9757788,45.8837574 62.9742775,45.1368455 L63.1199074,22.4400685 Z' id='black-stroke' stroke-width='2.235' stroke='#000000'></path>
<path d='M31.379261,48.8214352 C31.6119686,49.0550807 31.8424242,49.195268 32.0683759,49.2404897 C32.2950781,49.2864651 32.5157751,49.2796819 32.7289653,49.2208937 C32.9429062,49.1628591 33.1440857,49.0580955 33.3317531,48.9088638 C33.5194206,48.7588785 33.6845679,48.6134153 33.8264445,48.4702132 L36.9349682,45.3491614 C37.3493379,44.9331217 37.7637077,44.6663136 38.1788281,44.5494908 C38.5924471,44.4319144 38.9812941,44.3934759 39.3438676,44.4319144 C39.7064411,44.4718602 40.0337332,44.5660721 40.3249931,44.7160575 C40.6162529,44.8652891 40.8399525,45.0047227 40.9953412,45.135112 L41.0538934,45.0763238 C40.9240276,44.9195552 40.7814003,44.6994762 40.6267623,44.413072 C40.470623,44.1274215 40.3730359,43.8018252 40.3347518,43.4377904 C40.2957169,43.0737557 40.3475131,42.6705287 40.4901404,42.2281097 C40.632017,41.7864443 40.943545,41.3244291 41.4224723,40.8435716 L44.3756073,37.8785347 C44.530996,37.7225198 44.6826313,37.5506773 44.8327652,37.3622535 C44.9813979,37.173076 45.0849903,36.9718394 45.1427919,36.7570362 C45.2013441,36.5429868 45.2073495,36.3221541 45.1623093,36.0937845 C45.1165184,35.8669222 44.9776445,35.6355378 44.7449369,35.4018923 L43.6962511,34.3482264 L45.8716922,32.1640177 L48.3383932,34.6406601 C48.5590902,34.8622465 48.752763,35.1682468 48.9216637,35.5579072 C49.0898137,35.9475676 49.1866501,36.3703906 49.2129236,36.8256225 C49.2384463,37.2808544 49.1701354,37.7586972 49.0087414,38.2591508 C48.8473474,38.7596044 48.5455781,39.2314176 48.1056856,39.6730829 L44.4529263,43.3405638 C44.1293876,43.6654064 43.9184494,44.0068303 43.8223637,44.3640818 C43.7240259,44.722087 43.6985032,45.0597425 43.744294,45.3785556 C43.7893342,45.6973686 43.8861706,45.9898024 44.0355539,46.2566105 C44.1841865,46.5226649 44.3365725,46.7344532 44.4919611,46.8904681 L42.8022034,48.587036 C42.6468148,48.4310211 42.4358765,48.278021 42.1708901,48.1287893 C41.905153,47.978804 41.6198985,47.8755477 41.3158772,47.8167595 C41.0111053,47.7579713 40.6905692,47.7677693 40.3542692,47.8461536 C40.0172184,47.9237842 39.7004358,48.112208 39.4024199,48.411425 L35.6333068,52.1957286 C35.1934143,52.637394 34.723495,52.9403794 34.2250502,53.1024239 C33.7258548,53.2652221 33.2499301,53.3330546 32.7972762,53.307429 C32.3438717,53.2818034 31.9227459,53.183823 31.5346496,53.0149953 C31.1458027,52.8454138 30.8417814,52.6509605 30.6210845,52.4293741 L28.1543835,49.9527317 L30.3298246,47.7677693 L31.379261,48.8214352 Z' fill='#9B0000' id='Fill-19'></path>
<path d='M36.07958,26.7010842 C35.8461217,26.466685 35.615666,26.3272514 35.3897144,26.2820297 C35.1622615,26.2360543 34.9423152,26.2428376 34.729125,26.3016258 C34.5151841,26.3596603 34.3147552,26.4636703 34.1270878,26.6136556 C33.9386697,26.7636409 33.767517,26.9158874 33.6121283,27.0719023 L30.6589933,30.0369392 C30.180066,30.5177967 29.7191547,30.8298265 29.2800129,30.9722749 C28.8393697,31.1162307 28.4377613,31.1682356 28.0751878,31.1290435 C27.7126143,31.090605 27.3883249,30.9926247 27.1045718,30.8366098 C26.8185666,30.6805949 26.599371,30.5373928 26.4439823,30.4070035 L26.3854301,30.4657917 C26.5145453,30.6218066 26.6534192,30.8464078 26.8028025,31.1388415 C26.9514351,31.4312753 27.0452688,31.7598864 27.0843037,32.1231675 C27.1233385,32.4879559 27.0843037,32.87837 26.9679499,33.2936561 C26.8508454,33.7096958 26.5858589,34.1264893 26.1714892,34.542529 L23.0629655,37.6628271 C22.9203383,37.8060292 22.7747083,37.9718422 22.6260757,38.160266 C22.4774431,38.3486898 22.3731,38.5506801 22.3152984,38.7654832 C22.2567462,38.9795326 22.2499901,39.2003653 22.295781,39.428735 C22.3408212,39.6555972 22.4804458,39.8869816 22.7139041,40.1206272 L23.7625898,41.1735393 L21.586398,43.3585017 L19.119697,40.8818593 C18.8990001,40.6602729 18.7053273,40.3542727 18.5364266,39.9646122 C18.3682766,39.5749518 18.2706895,39.1521288 18.2451667,38.6968969 C18.2196439,38.241665 18.2872042,37.7638223 18.4493489,37.2633687 C18.6107429,36.7621614 18.9125122,36.2911019 19.3524047,35.8486828 L23.1215178,32.0651329 C23.4195337,31.7659159 23.6064505,31.4471029 23.6852708,31.1094474 C23.7625898,30.771792 23.7723485,30.4499641 23.7137962,30.1432102 C23.655244,29.8379636 23.5516516,29.5515595 23.4030189,29.2855051 C23.2543863,29.018697 23.1087564,28.8144456 22.9661291,28.6712435 L24.6566375,26.9739219 C24.7985141,27.117124 25.0019456,27.2633409 25.2676827,27.4133262 C25.5334199,27.5625578 25.8246797,27.6605382 26.1422131,27.7050062 C26.4597464,27.7517353 26.7960465,27.725356 27.1526146,27.6273756 C27.5076814,27.530149 27.8484855,27.3191143 28.1720242,26.993518 L31.8247835,23.3267909 C32.264676,22.8843718 32.7345953,22.58214 33.2330401,22.4200955 C33.7314848,22.2572974 34.2074095,22.1894648 34.660814,22.2150904 C35.1142186,22.2407161 35.5353444,22.3386965 35.9234406,22.5075242 C36.3115369,22.6771056 36.6163089,22.871559 36.8370058,23.0931453 L39.3037068,25.5697878 L37.1282657,27.7539964 L36.07958,26.7010842 Z' fill='#9B0000' id='Fill-21'></path>
</g>
</g>
<path d='M100.843301,63.5962709 C100.843301,64.1939346 101.179487,64.5301205 101.77715,64.5301205 L108.575575,64.5301205 C109.061177,64.5301205 109.397363,64.3807046 109.733549,64.0445187 L111.003584,62.7744833 C111.33977,62.4382975 111.489186,62.1021116 111.489186,61.6165099 L111.489186,39.0547046 C111.489186,38.5691028 111.33977,38.2329169 111.003584,37.8967311 L109.733549,36.6266957 C109.397363,36.2905099 109.061177,36.1410939 108.575575,36.1410939 L101.77715,36.1410939 C101.179487,36.1410939 100.843301,36.4772798 100.843301,37.0749435 L100.843301,63.5962709 Z M107.156124,61.4670939 L104.429283,61.4670939 L104.429283,39.2041205 L107.156124,39.2041205 L107.903204,39.9512001 L107.903204,60.7200143 L107.156124,61.4670939 Z M122.428469,37.0749435 C122.428469,36.4772798 122.092283,36.1410939 121.494619,36.1410939 L119.776336,36.1410939 C119.178673,36.1410939 118.842487,36.4772798 118.842487,37.0749435 L118.842487,63.5962709 C118.842487,64.1939346 119.178673,64.5301205 119.776336,64.5301205 L121.494619,64.5301205 C122.092283,64.5301205 122.428469,64.1939346 122.428469,63.5962709 L122.428469,37.0749435 Z M138.821434,62.4009435 C138.821434,61.8032798 138.485248,61.4670939 137.887584,61.4670939 L133.479814,61.4670939 L133.479814,51.6803506 L137.140504,51.6803506 C137.738168,51.6803506 138.074354,51.3441647 138.074354,50.746501 L138.074354,49.5511736 C138.074354,48.9535099 137.738168,48.617324 137.140504,48.617324 L133.479814,48.617324 L133.479814,39.2041205 L137.812876,39.2041205 C138.41054,39.2041205 138.746726,38.8679346 138.746726,38.2702709 L138.746726,37.0749435 C138.746726,36.4772798 138.41054,36.1410939 137.812876,36.1410939 L130.827681,36.1410939 C130.230018,36.1410939 129.893832,36.4772798 129.893832,37.0749435 L129.893832,63.5962709 C129.893832,64.1939346 130.230018,64.5301205 130.827681,64.5301205 L137.887584,64.5301205 C138.485248,64.5301205 138.821434,64.1939346 138.821434,63.5962709 L138.821434,62.4009435 Z M155.214398,39.0547046 C155.214398,38.5691028 155.064982,38.2329169 154.728796,37.8967311 L153.458761,36.6266957 C153.122575,36.2905099 152.786389,36.1410939 152.300788,36.1410939 L148.154496,36.1410939 C147.668894,36.1410939 147.332708,36.2905099 146.996522,36.6266957 L145.726487,37.8967311 C145.390301,38.2329169 145.240885,38.5691028 145.240885,39.0547046 L145.240885,48.76674 C145.240885,49.2523417 145.390301,49.5885276 145.726487,49.9247134 L146.996522,51.1947488 C147.332708,51.5309346 147.668894,51.6803506 148.154496,51.6803506 L150.993398,51.6803506 L151.740478,52.4274302 L151.740478,60.7947223 L150.993398,61.5418019 L149.499239,61.5418019 L148.752159,60.7947223 L148.752159,57.2834479 C148.752159,56.6857842 148.415973,56.3495984 147.81831,56.3495984 L146.100027,56.3495984 C145.502363,56.3495984 145.166177,56.6857842 145.166177,57.2834479 L145.166177,61.6165099 C145.166177,62.1021116 145.315593,62.4382975 145.651779,62.7744833 L146.921814,64.0445187 C147.258,64.3807046 147.594186,64.5301205 148.079788,64.5301205 L152.41285,64.5301205 C152.898451,64.5301205 153.234637,64.3807046 153.570823,64.0445187 L154.840858,62.7744833 C155.177044,62.4382975 155.32646,62.1021116 155.32646,61.6165099 L155.32646,51.5309346 C155.32646,51.0453329 155.177044,50.709147 154.840858,50.3729612 L153.570823,49.1029258 C153.234637,48.76674 152.898451,48.617324 152.41285,48.617324 L149.573947,48.617324 L148.826867,47.8702444 L148.826867,39.8764922 L149.573947,39.1294125 L150.881336,39.1294125 L151.628416,39.8764922 L151.628416,43.4251205 C151.628416,44.0227842 151.964602,44.35897 152.562265,44.35897 L154.280549,44.35897 C154.878212,44.35897 155.214398,44.0227842 155.214398,43.4251205 L155.214398,39.0547046 Z M171.383239,62.4009435 C171.383239,61.8032798 171.047053,61.4670939 170.449389,61.4670939 L166.041619,61.4670939 L166.041619,51.6803506 L169.70231,51.6803506 C170.299973,51.6803506 170.636159,51.3441647 170.636159,50.746501 L170.636159,49.5511736 C170.636159,48.9535099 170.299973,48.617324 169.70231,48.617324 L166.041619,48.617324 L166.041619,39.2041205 L170.374681,39.2041205 C170.972345,39.2041205 171.308531,38.8679346 171.308531,38.2702709 L171.308531,37.0749435 C171.308531,36.4772798 170.972345,36.1410939 170.374681,36.1410939 L163.389487,36.1410939 C162.791823,36.1410939 162.455637,36.4772798 162.455637,37.0749435 L162.455637,63.5962709 C162.455637,64.1939346 162.791823,64.5301205 163.389487,64.5301205 L170.449389,64.5301205 C171.047053,64.5301205 171.383239,64.1939346 171.383239,63.5962709 L171.383239,62.4009435 Z M181.874274,61.4670939 L181.874274,37.0749435 C181.874274,36.4772798 181.538088,36.1410939 180.940425,36.1410939 L179.222142,36.1410939 C178.624478,36.1410939 178.288292,36.4772798 178.288292,37.0749435 L178.288292,63.5962709 C178.288292,64.1939346 178.624478,64.5301205 179.222142,64.5301205 L185.684381,64.5301205 C186.282044,64.5301205 186.61823,64.1939346 186.61823,63.5962709 L186.61823,62.4009435 C186.61823,61.8032798 186.282044,61.4670939 185.684381,61.4670939 L181.874274,61.4670939 Z' fill='#FFFFFF' id='DIESEL' sketch:type='MSShapeGroup'></path>
</g>
</g>
</g>
                    </svg>
                </a>
            </h1>
            <nav class="header-nav">
                <ul>
                    <li class="nav-item">
                      <a href="/news">News</a>
                    </li>
                    <li class="nav-item">
                        <a href="/guides">Guides</a>
                    </li>
                    <li class="nav-item">
                        <a href="/docs">API Docs</a>
                    </li>
                    <li class="nav-item">
                      <a href="/changelog.html">Changelog</a>
                    </li>
                    <li class="nav-item">
                      <a href="https://github.com/diesel-rs/diesel"><img src="/assets/images/github-mark.svg" style="height: 2em;"/></a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    <main>
    <section class = "banner">
        <div class = "content-wrapper">
            <div class = "banner-wrapper">
                <h2 class = "banner__heading">Getting Started with
Diesel</h2>
            </div>
        </div>
    </section>

<div class="demo">
<div class="content-wrapper">
<div class="guide-wrapper">
<div class="btn-container">
<!-- PostgreSQL button is selected by default. If this ever changes, also modify the postgres-example CSS class -->
<p><a href="javascript:void(0)" class="btn btn-primary db-type-button"
onclick="change_db_type(event, &#39;postgres&#39;)">PostgreSQL</a> <a
href="javascript:void(0)" class="btn db-type-button"
onclick="change_db_type(event, &#39;sqlite&#39;)">SQLite</a> <a
href="javascript:void(0)" class="btn db-type-button"
onclick="change_db_type(event, &#39;mysql&#39;)">MySQL</a></p>
</div>
<p>For this guide, we’re going to walk through some simple examples for
each of the pieces of CRUD, which stands for “Create Read Update
Delete”. Each step in this guide will build on the previous and is meant
to be followed along.</p>
<p>Before we start, make sure you have one of PostgreSQL, SQLite, or
MySQL installed and running. In the project repository, you may find
various <a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples">examples</a>
for every supported database.</p>
<aside class="aside aside--note">
<header class="aside__header">
A note on Rust versions:
</header>
<div class="aside__text">
<p>Diesel requires Rust 1.86.0 or later. If you’re following along with
this guide, make sure you’re using at least that version of Rust by
running <code>rustup update stable</code>.</p>
</div>
</aside>
<h2 id="initializing-a-new-project"><a
href="#initializing-a-new-project" class="anchor"
aria-hidden="true"></a>Initializing a new project</h2>
<p>The first thing we need to do is generate our project.</p>
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
Generate a new project
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> new <span class="at">--lib</span> diesel_demo</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> diesel_demo</span></code></pre></div>
</div>
</div>
<p>First, let’s add Diesel to our dependencies. We’re also going to use
a tool called <a
href="https://github.com/allan2/dotenvy"><code>.env</code></a> to manage
our environment variables for us. We’ll add it to our dependencies as
well.</p>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
Cargo.toml (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_1/Cargo.toml">View on GitHub</a>
<div class="sourceCode" id="cb2"><pre
class="sourceCode toml"><code class="sourceCode toml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="dt">dependencies</span><span class="kw">]</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dt">diesel</span> <span class="op">=</span> <span class="op">{ </span><span class="dt">version</span><span class="op"> =</span> <span class="st">&quot;2.2.0&quot;</span><span class="op">, </span><span class="dt">features</span><span class="op"> =</span> <span class="op">[</span><span class="st">&quot;postgres&quot;</span><span class="op">]</span> <span class="op">}</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># build libpq and openssl as part of the build process</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment these lines if you run into setup issues</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pq-sys = { version = &quot;0.6&quot;, features = [&quot;bundled&quot;] }</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># openssl-sys = { version = &quot;0.9.100&quot;, features = [&quot;vendored&quot;] } </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="dt">dotenvy</span> <span class="op">=</span> <span class="st">&quot;0.15&quot;</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
Cargo.toml (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_1/Cargo.toml">View on GitHub</a>
<div class="sourceCode" id="cb3"><pre
class="sourceCode toml"><code class="sourceCode toml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="dt">dependencies</span><span class="kw">]</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dt">diesel</span> <span class="op">=</span> <span class="op">{ </span><span class="dt">version</span><span class="op"> =</span> <span class="st">&quot;2.2.0&quot;</span><span class="op">, </span><span class="dt">features</span><span class="op"> =</span> <span class="op">[</span><span class="st">&quot;sqlite&quot;</span><span class="op">,</span> <span class="st">&quot;returning_clauses_for_sqlite_3_35&quot;</span><span class="op">]</span> <span class="op">}</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># build libsqlite3 as part of the build process</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment this line if you run into setup issues</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># libsqlite3-sys = { version = &quot;0.30&quot;, features = [&quot;bundled&quot;] }</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="dt">dotenvy</span> <span class="op">=</span> <span class="st">&quot;0.15&quot;</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
Cargo.toml (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_1/Cargo.toml">View on GitHub</a>
<div class="sourceCode" id="cb4"><pre
class="sourceCode toml"><code class="sourceCode toml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">[</span><span class="dt">dependencies</span><span class="kw">]</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="dt">diesel</span> <span class="op">=</span> <span class="op">{ </span><span class="dt">version</span><span class="op"> =</span> <span class="st">&quot;2.2.0&quot;</span><span class="op">, </span><span class="dt">features</span><span class="op"> =</span> <span class="op">[</span><span class="st">&quot;mysql&quot;</span><span class="op">]</span> <span class="op">}</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># build libmysqlclient as part of the build process</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment this line if you run into setup issues</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mysqlclient-sys = { version = &quot;0.4&quot;, features = [&quot;bundled&quot;] }</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dt">dotenvy</span> <span class="op">=</span> <span class="st">&quot;0.15&quot;</span></span></code></pre></div>
</div>
</div>
</div>
<h2 id="installing-diesel-cli"><a href="#installing-diesel-cli"
class="anchor" aria-hidden="true"></a>Installing Diesel CLI</h2>
<p>Diesel provides a separate <a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/diesel_cli">CLI</a>
tool to help manage your project. Since it’s a standalone binary, and
doesn’t affect your project’s code directly, we don’t add it to
<code>Cargo.toml</code>. Instead, we just install it on our system.</p>
<p>We provide pre-built binaries for diesel cli. You can install the
command line tool via:</p>
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
Install the CLI tool
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Linux/MacOS</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">--proto</span> <span class="st">&#39;=https&#39;</span> <span class="at">--tlsv1.2</span> <span class="at">-LsSf</span> https://github.com/diesel-rs/diesel/releases/latest/download/diesel_cli-installer.sh <span class="kw">|</span> <span class="fu">sh</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Windows (powershell)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Set-ExecutionPolicy</span> RemoteSigned <span class="at">-scope</span> CurrentUser</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="ex">irm</span> https://github.com/diesel-rs/diesel/releases/latest/download/diesel_cli-installer.ps1 <span class="kw">|</span> <span class="ex">iex</span></span></code></pre></div>
</div>
</div>
<p>You also can use <a
href="https://github.com/cargo-bins/cargo-binstall"><code>cargo-binstall</code></a>
for this. To install diesel cli with <code>cargo binstall</code> run the
following command:</p>
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
Install with cargo binstall
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> binstall diesel_cli</span></code></pre></div>
</div>
</div>
<p>This automatically finds the right binary for your system.</p>
<p>Alternatively you can manually install diesel cli by using
<code>cargo install:</code></p>
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
Install the CLI tool
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> install diesel_cli</span></code></pre></div>
</div>
</div>
<aside class="aside aside--note">
<header class="aside__header">
A note on installing <code>diesel_cli</code>
</header>
<div class="aside__text">
<p>If you run into an error like:</p>
<pre><code>note: ld: library not found for -lmysqlclient
clang: error: linker command failed with exit code 1 (use -v to see invocation)</code></pre>
<p>This means you are missing the client library needed for a database
backend – <code>mysqlclient</code> in this case. You can resolve this
issue by either installing the library (using the usual way to do this
depending on your operating system) or by excluding the undesired
default library with the <code>--no-default-features</code> flag.</p>
<p>By default diesel CLI depends on the following client libraries:</p>
<ul>
<li><a
href="https://www.postgresql.org/docs/current/libpq.html"><code>libpq</code></a>
for the PostgreSQL backend</li>
<li><a
href="https://dev.mysql.com/doc/c-api/8.0/en/c-api-implementations.html"><code>libmysqlclient</code></a>
for the Mysql backend</li>
<li><a
href="https://www.sqlite.org/index.html"><code>libsqlite3</code></a> for
the SQLite backend</li>
</ul>
<p>If you are not sure on how to install those dependencies please
consult the documentation of the corresponding dependency or your
distribution package manager. By default diesel will dynamically link
these libraries, which means they need to be present on your system at
build and runtime.</p>
<div class="postgres-example">
<p>For example, if you only have PostgreSQL installed, you can use this
to install <code>diesel_cli</code> with only PostgreSQL:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> install diesel_cli <span class="at">--no-default-features</span> <span class="at">--features</span> postgres</span></code></pre></div>
</div>
<div class="sqlite-example">
<p>For example, if you only have SQLite installed, you can use this to
install <code>diesel_cli</code> with only SQLite:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> install diesel_cli <span class="at">--no-default-features</span> <span class="at">--features</span> sqlite</span></code></pre></div>
</div>
<div class="mysql-example">
<p>For example, if you only have MySQL installed, you can use this to
install <code>diesel_cli</code> with only MySQL:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> install diesel_cli <span class="at">--no-default-features</span> <span class="at">--features</span> mysql</span></code></pre></div>
</div>
<p>If you are unsure how to configure these dependencies checkout <a
href="https://github.com/diesel-rs/diesel/blob/master/.github/workflows/ci.yml#L63-L222">diesel
CI</a> configuration for a working setup for different operating
systems.</p>
<p>Diesel-cli also offers features to build and statically link these
libraries during <code>cargo install</code>. Use the
<code>postgres-bundled</code>, <code>mysql-bundled</code> and
<code>sqlite-bundled</code> feature flags for this. You need to provide
the build dependencies for these libraries in that case. This involves a
C compiler for all of them and for mysql cmake + a C++ compiler. In turn
it might simplify your setup process.</p>
<p>There are no <code>*-bundled</code> features for diesel itself. If
you want to utilise static linking there as well you need to add a
dependency on the relevant sys crate (<code>pq-sys</code> for
PostgreSQL, <code>mysqlclient-sys</code> for MySQL and
<code>libsqlite3-sys</code> for SQLite) and enable the
<code>bundled</code> feature for this crate. See the uncommented lines
in the example <code>Cargo.toml</code> files above for the corresponding
setup.</p>
</div>
</aside>
<h2 id="setup-diesel-for-your-project"><a
href="#setup-diesel-for-your-project" class="anchor"
aria-hidden="true"></a>Setup Diesel for your project</h2>
<p>We need to tell Diesel where to find our database. We do this by
setting the <code>DATABASE_URL</code> environment variable. On our
development machines, we’ll likely have multiple projects going, and we
don’t want to pollute our environment. We can put the url in a
<code>.env</code> file instead.</p>
<div class="postgres-example">
<div class="sourceCode" id="cb12"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> DATABASE_URL=postgres://username:password@localhost/diesel_demo <span class="op">&gt;</span> .env</span></code></pre></div>
</div>
<div class="sqlite-example">
<div class="sourceCode" id="cb13"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> DATABASE_URL=/path/to/your/sqlite/database.db <span class="op">&gt;</span> .env</span></code></pre></div>
</div>
<div class="mysql-example">
<div class="sourceCode" id="cb14"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> DATABASE_URL=mysql://username:password@localhost/diesel_demo <span class="op">&gt;</span> .env</span></code></pre></div>
</div>
<p>Now Diesel CLI can set everything up for us.</p>
<pre><code>diesel setup</code></pre>
<p>This will create our database (if it didn’t already exist) and set up
the initial migrations directory, which will contain a generated
migration file that establishes the Diesel setup. Note that the
migrations directory will not be empty as the initial setup migration is
automatically generated.</p>
<p>Now we’re going to write a small CLI that lets us manage a blog
(ignoring the fact that we can only access the database from this CLI…).
The first thing we’re going to need is a table to store our posts. Let’s
create a migration for that:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">diesel</span> migration generate create_posts</span></code></pre></div>
<p>Diesel CLI will create two empty files for us in the required
structure. You’ll see output that looks something like this:</p>
<pre><code>Creating migrations/20160815133237_create_posts/up.sql
Creating migrations/20160815133237_create_posts/down.sql</code></pre>
<p>Migrations allow us to evolve the database schema over time. Each
migration consists of an <code>up.sql</code> file to apply the changes
and a <code>down.sql</code> file to revert them. Applying and
immediately reverting a migration should leave your database schema
unchanged.</p>
<p>Next, we’ll write the SQL for migrations:</p>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
up.sql (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/tree/2.3.x/examples/postgres/getting_started_step_1/migrations/20160815133237_create_posts/up.sql">View on GitHub</a>
<div class="sourceCode" id="cb18"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> posts (</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">id</span> SERIAL <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  title <span class="dt">VARCHAR</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">body</span> TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  published <span class="dt">BOOLEAN</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="kw">FALSE</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
up.sql (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_1/migrations/20170124012402_create_posts/up.sql">View on GitHub</a>
<div class="sourceCode" id="cb19"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> posts (</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">id</span> <span class="dt">INTEGER</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">PRIMARY</span> <span class="kw">KEY</span> AUTOINCREMENT,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  title <span class="dt">VARCHAR</span> <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">body</span> TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  published <span class="dt">BOOLEAN</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="dv">0</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
up.sql (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_1/migrations/20160815133237_create_posts/up.sql">View on GitHub</a>
<div class="sourceCode" id="cb20"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> posts (</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">id</span> <span class="dt">INTEGER</span> AUTO_INCREMENT <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  title <span class="dt">VARCHAR</span>(<span class="dv">255</span>) <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">body</span> TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  published <span class="dt">BOOLEAN</span> <span class="kw">NOT</span> <span class="kw">NULL</span> <span class="kw">DEFAULT</span> <span class="kw">FALSE</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
</div>
</div>
</div>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
down.sql (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/tree/2.3.x/examples/postgres/getting_started_step_1/migrations/20160815133237_create_posts/down.sql">View on GitHub</a>
<div class="sourceCode" id="cb21"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> posts</span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
down.sql (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_1/migrations/20170124012402_create_posts/down.sql">View on GitHub</a>
<div class="sourceCode" id="cb22"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> posts</span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
down.sql (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_1/migrations/20160815133237_create_posts/down.sql">View on GitHub</a>
<div class="sourceCode" id="cb23"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">DROP</span> <span class="kw">TABLE</span> posts</span></code></pre></div>
</div>
</div>
</div>
<p>We can apply our new migration:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode sh"><code class="sourceCode bash"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="ex">diesel</span> migration run</span></code></pre></div>
<p>It’s a good idea to ensure that <code>down.sql</code> is correct. You
can quickly confirm that your <code>down.sql</code> rolls back your
migration correctly by <code>redoing</code> the migration:</p>
<pre><code>diesel migration redo</code></pre>
<aside class="aside aside--note">
<header class="aside__header">
A Note on Raw SQL in Migrations:
</header>
<div class="aside__text">
<p>Since migrations are written in raw SQL, they can contain specific
features of the database system you use. For example, the
<code>CREATE TABLE</code> statement above uses PostgreSQL’s
<code>SERIAL</code> type. If you want to use SQLite instead, you need to
use <code>INTEGER</code> instead. The <a
href="https://github.com/diesel-rs/diesel/tree/master/examples">diesel
GitHub repository</a> contains modified examples for all supported
backends. Be sure to select the backend you are using at the top of the
page to see examples specific for that backend.</p>
<p>If you prefer to generate your migrations based on Rust code instead,
the diesel CLI tool provides an additional <code>--diff-schema</code> on
the <code>diesel migration generate</code> command that allows to
generate migrations based on the current schema definition and your
database. To generate a migration equivalent to the shown Raw SQL
migration you need to</p>
<ul>
<li>Create a <code>schema.rs</code> file with the following
content:</li>
</ul>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
schema.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_1/src/schema.rs">View on GitHub</a>
<div class="sourceCode" id="cb26"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="pp">diesel::table!</span> <span class="op">{</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    posts (id) <span class="op">{</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        id <span class="op">-&gt;</span> Int4<span class="op">,</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        title <span class="op">-&gt;</span> Varchar<span class="op">,</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        body <span class="op">-&gt;</span> Text<span class="op">,</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        published <span class="op">-&gt;</span> Bool<span class="op">,</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
schema.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_1/src/schema.rs">View on GitHub</a>
<div class="sourceCode" id="cb27"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="pp">diesel::table!</span> <span class="op">{</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    posts (id) <span class="op">{</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        id <span class="op">-&gt;</span> Integer<span class="op">,</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        title <span class="op">-&gt;</span> Text<span class="op">,</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>        body <span class="op">-&gt;</span> Text<span class="op">,</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>        published <span class="op">-&gt;</span> Bool<span class="op">,</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
schema.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_1/src/schema.rs">View on GitHub</a>
<div class="sourceCode" id="cb28"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="pp">diesel::table!</span> <span class="op">{</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    posts (id) <span class="op">{</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        id <span class="op">-&gt;</span> Integer<span class="op">,</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>        title <span class="op">-&gt;</span> Varchar<span class="op">,</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        body <span class="op">-&gt;</span> Text<span class="op">,</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        published <span class="op">-&gt;</span> Bool<span class="op">,</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<p><a href="https://docs.diesel.rs/2.3.x/diesel/macro.table.html">The
documentation of the <code>table!</code> macro</a> contains the syntax
used for this macros. <a
href="https://docs.diesel.rs/2.3.x/diesel/sql_types/index.html">The
<code>diesel::sql_types</code> module</a> provides documentation for the
SQL side types used to define the relevant columns.</p>
<ul>
<li>Run
<code>diesel migration generate --diff-schema create_posts</code></li>
</ul>
<p>This will generate both the <code>up.sql</code> and the
<code>down.sql</code> files of your migration pre-populated with the
relevant SQL. These pre-populated migration files can serve as starting
point to adjust the generated SQL to your needs. You as as user need to
decide which modifications are relevant for your use case as Diesel will
never generate a completly perfect migration for you. For this guide for
example you need to add a <code>DEFAULT</code> clause to the
<code>published</code> field to match the migration shown earlier.</p>
</div>
</aside>
<aside class="aside aside--note">
<header class="aside__header">
A Note on Using Migrations in Production:
</header>
<div class="aside__text">
<p>When preparing your app for use in production, you may want to run
your migrations during the application’s initialization phase. You may
also want to include the migration scripts as a part of your code, to
avoid having to copy them to your deployment location/image etc.</p>
<p>The <a
href="https://docs.rs/crate/diesel_migrations/2.2.0">diesel_migrations</a>
crate provides the <a
href="https://docs.rs/diesel_migrations/2.2.0/diesel_migrations/macro.embed_migrations.html"><code>embed_migrations!</code></a>
macro, allowing you to embed migration scripts in the final binary. Once
your code uses it, you can simply include
<code>connection.run_pending_migrations(MIGRATIONS)</code> at the start
of your <code>main</code> function to run migrations every time the
application starts.</p>
</div>
</aside>
<h2 id="write-rust"><a href="#write-rust" class="anchor"
aria-hidden="true"></a>Write Rust</h2>
<p>OK enough SQL, let’s write some Rust. We’ll start by writing some
code to show the last five published posts. The first thing we need to
do is establish a database connection.</p>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/lib.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_1/src/lib.rs">View on GitHub</a>
<div class="sourceCode" id="cb29"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">dotenvy::</span>dotenv<span class="op">;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::</span>env<span class="op">;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">fn</span> establish_connection() <span class="op">-&gt;</span> PgConnection <span class="op">{</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    dotenv()<span class="op">.</span>ok()<span class="op">;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> database_url <span class="op">=</span> <span class="pp">env::</span>var(<span class="st">&quot;DATABASE_URL&quot;</span>)<span class="op">.</span>expect(<span class="st">&quot;DATABASE_URL must be set&quot;</span>)<span class="op">;</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="pp">PgConnection::</span>establish(<span class="op">&amp;</span>database_url)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>unwrap_or_else(<span class="op">|</span>_<span class="op">|</span> <span class="pp">panic!</span>(<span class="st">&quot;Error connecting to {}&quot;</span><span class="op">,</span> database_url))</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/lib.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_1/src/lib.rs">View on GitHub</a>
<div class="sourceCode" id="cb30"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">dotenvy::</span>dotenv<span class="op">;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::</span>env<span class="op">;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">fn</span> establish_connection() <span class="op">-&gt;</span> SqliteConnection <span class="op">{</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    dotenv()<span class="op">.</span>ok()<span class="op">;</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> database_url <span class="op">=</span> <span class="pp">env::</span>var(<span class="st">&quot;DATABASE_URL&quot;</span>)<span class="op">.</span>expect(<span class="st">&quot;DATABASE_URL must be set&quot;</span>)<span class="op">;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="pp">SqliteConnection::</span>establish(<span class="op">&amp;</span>database_url)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>unwrap_or_else(<span class="op">|</span>_<span class="op">|</span> <span class="pp">panic!</span>(<span class="st">&quot;Error connecting to {}&quot;</span><span class="op">,</span> database_url))</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/lib.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_1/src/lib.rs">View on GitHub</a>
<div class="sourceCode" id="cb31"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">dotenvy::</span>dotenv<span class="op">;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::</span>env<span class="op">;</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">fn</span> establish_connection() <span class="op">-&gt;</span> MysqlConnection <span class="op">{</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    dotenv()<span class="op">.</span>ok()<span class="op">;</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> database_url <span class="op">=</span> <span class="pp">env::</span>var(<span class="st">&quot;DATABASE_URL&quot;</span>)<span class="op">.</span>expect(<span class="st">&quot;DATABASE_URL must be set&quot;</span>)<span class="op">;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="pp">MysqlConnection::</span>establish(<span class="op">&amp;</span>database_url)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>unwrap_or_else(<span class="op">|</span>_<span class="op">|</span> <span class="pp">panic!</span>(<span class="st">&quot;Error connecting to {}&quot;</span><span class="op">,</span> database_url))</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<p>We’ll also want to create a <code>Post</code> struct into which we
can read our data, and have diesel generate the names we’ll use to
reference tables and columns in our queries.</p>
<p>We’ll add the following lines to the top of
<code>src/lib.rs</code>:</p>
<div>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/lib.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/tree/2.3.x/examples/postgres/getting_started_step_1/src/lib.rs#L1-L2">View on GitHub</a>
<div class="sourceCode" id="cb32"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">mod</span> models<span class="op">;</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">mod</span> schema<span class="op">;</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/lib.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/tree/2.3.x/examples/sqlite/getting_started_step_1/src/lib.rs#L1-L2">View on GitHub</a>
<div class="sourceCode" id="cb33"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">mod</span> models<span class="op">;</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">mod</span> schema<span class="op">;</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/lib.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/tree/2.3.x/examples/mysql/getting_started_step_1/src/lib.rs#L1-L2">View on GitHub</a>
<div class="sourceCode" id="cb34"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">mod</span> models<span class="op">;</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">mod</span> schema<span class="op">;</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<p>Next we need to create the two modules that we just declared.</p>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/models.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/tree/2.3.x/examples/postgres/getting_started_step_1/src/models.rs">View on GitHub</a>
<div class="sourceCode" id="cb35"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>derive<span class="at">(</span>Queryable<span class="op">,</span> Selectable<span class="at">)]</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>diesel<span class="at">(</span>table_name <span class="op">=</span> <span class="kw">crate</span><span class="pp">::schema::</span>posts<span class="at">)]</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>diesel<span class="at">(</span>check_for_backend<span class="at">(</span><span class="pp">diesel::pg::</span>Pg<span class="at">))]</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">struct</span> Post <span class="op">{</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> id<span class="op">:</span> <span class="dt">i32</span><span class="op">,</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> title<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> body<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> published<span class="op">:</span> <span class="dt">bool</span><span class="op">,</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/models.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/tree/2.3.x/examples/sqlite/getting_started_step_1/src/models.rs">View on GitHub</a>
<div class="sourceCode" id="cb36"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>derive<span class="at">(</span>Queryable<span class="op">,</span> Selectable<span class="at">)]</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>diesel<span class="at">(</span>table_name <span class="op">=</span> <span class="kw">crate</span><span class="pp">::schema::</span>posts<span class="at">)]</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>diesel<span class="at">(</span>check_for_backend<span class="at">(</span><span class="pp">diesel::sqlite::</span>Sqlite<span class="at">))]</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">struct</span> Post <span class="op">{</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> id<span class="op">:</span> <span class="dt">i32</span><span class="op">,</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> title<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> body<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> published<span class="op">:</span> <span class="dt">bool</span><span class="op">,</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/models.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/tree/2.3.x/examples/mysql/getting_started_step_1/src/models.rs">View on GitHub</a>
<div class="sourceCode" id="cb37"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>derive<span class="at">(</span>Queryable<span class="op">,</span> Selectable<span class="at">)]</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>diesel<span class="at">(</span>table_name <span class="op">=</span> <span class="kw">crate</span><span class="pp">::schema::</span>posts<span class="at">)]</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>diesel<span class="at">(</span>check_for_backend<span class="at">(</span><span class="pp">diesel::mysql::</span>Mysql<span class="at">))]</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">struct</span> Post <span class="op">{</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> id<span class="op">:</span> <span class="dt">i32</span><span class="op">,</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> title<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> body<span class="op">:</span> <span class="dt">String</span><span class="op">,</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> published<span class="op">:</span> <span class="dt">bool</span><span class="op">,</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<p><a
href="https://docs.diesel.rs/master/diesel/prelude/derive.Queryable.html"><code>#[derive(Queryable)]</code></a>
will generate all of the code needed to load a <code>Post</code> struct
from a SQL query. <a
href="https://docs.diesel.rs/master/diesel/prelude/derive.Selectable.html"><code>#[derive(Selectable)]</code></a>
will generate code to construct a matching select clause based on your
model type based on the table defined via
<code>#[diesel(table_name = crate::schema::posts)]</code>.
<code>#[diesel(check_for_backend(diesel::pg::Pg))</code> (or
<code>sqlite::SQLite</code> or <code>mysql::MySQL</code>) adds
additional compile time checks to verify that all field types in your
struct are compatible with their corresponding SQL side expressions.
This part is optional, but it greatly improves the generated compiler
error messages.</p>
<p>Typically the schema module isn’t created by hand, it gets generated
by diesel CLI. When we ran <code>diesel setup</code>, a file called <a
href="https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_1/diesel.toml">diesel.toml</a>
was created which tells Diesel to maintain a file at
<code>src/schema.rs</code> for us. The file should look like this:</p>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
schema.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_1/src/schema.rs">View on GitHub</a>
<div class="sourceCode" id="cb38"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="pp">diesel::table!</span> <span class="op">{</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    posts (id) <span class="op">{</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>        id <span class="op">-&gt;</span> Int4<span class="op">,</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        title <span class="op">-&gt;</span> Varchar<span class="op">,</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        body <span class="op">-&gt;</span> Text<span class="op">,</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        published <span class="op">-&gt;</span> Bool<span class="op">,</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
schema.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_1/src/schema.rs">View on GitHub</a>
<div class="sourceCode" id="cb39"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="pp">diesel::table!</span> <span class="op">{</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    posts (id) <span class="op">{</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>        id <span class="op">-&gt;</span> Integer<span class="op">,</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>        title <span class="op">-&gt;</span> Text<span class="op">,</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>        body <span class="op">-&gt;</span> Text<span class="op">,</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>        published <span class="op">-&gt;</span> Bool<span class="op">,</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
schema.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_1/src/schema.rs">View on GitHub</a>
<div class="sourceCode" id="cb40"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="pp">diesel::table!</span> <span class="op">{</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    posts (id) <span class="op">{</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>        id <span class="op">-&gt;</span> Integer<span class="op">,</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>        title <span class="op">-&gt;</span> Varchar<span class="op">,</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>        body <span class="op">-&gt;</span> Text<span class="op">,</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>        published <span class="op">-&gt;</span> Bool<span class="op">,</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<p>The exact output might vary slightly depending on your database, but
it should be equivalent.</p>
<p>The <a
href="https://docs.diesel.rs/2.3.x/diesel/macro.table.html"><code>table!</code>
macro</a> creates a bunch of code based on the database schema to
represent all of the tables and columns. We’ll see how exactly to use
that in the next example. For a deep dive into the generated code see
the <a href="schema-in-depth.html">Schema in Depth</a> guide.</p>
<p>Any time we run or revert a migration, this file will get
automatically updated.</p>
<aside class="aside aside--note">
<header class="aside__header">
A Note on Field Order
</header>
<div class="aside__text">
<p>Using <code>#[derive(Queryable)]</code> assumes that the order of
fields on the <code>Post</code> struct matches the columns in the
<code>posts</code> table, so make sure to define them in the order seen
in the <code>schema.rs</code> file. Using
<code>#[derive(Selectable)]</code> in combination with <a
href="https://docs.diesel.rs/2.3.x/diesel/prelude/trait.SelectableHelper.html#tymethod.as_select"><code>SelectableHelper::as_select</code></a>
ensures that the field order always matches. The
<code>#[diesel(check_for_backend(diesel::pg::Pg))]</code> attribute
provides a further check that all field types match which what your
query is returning. This attribute can improve the error messages
generated by the compiler significantly.</p>
</div>
</aside>
<p>Let’s write the code to actually show us our posts.</p>
<div>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/show_posts.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_1/src/bin/show_posts.rs">View on GitHub</a>
<div class="sourceCode" id="cb41"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span><span class="op">*;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span><span class="op">*;</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> results <span class="op">=</span> posts</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>filter(published<span class="op">.</span>eq(<span class="cn">true</span>))</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>limit(<span class="dv">5</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>select(<span class="pp">Post::</span>as_select())</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>load(connection)</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Error loading posts&quot;</span>)<span class="op">;</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;Displaying {} posts&quot;</span><span class="op">,</span> results<span class="op">.</span>len())<span class="op">;</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> post <span class="kw">in</span> results <span class="op">{</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>        <span class="pp">println!</span>(<span class="st">&quot;{}&quot;</span><span class="op">,</span> post<span class="op">.</span>title)<span class="op">;</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>        <span class="pp">println!</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="op">;</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>        <span class="pp">println!</span>(<span class="st">&quot;{}&quot;</span><span class="op">,</span> post<span class="op">.</span>body)<span class="op">;</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/show_posts.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_1/src/bin/show_posts.rs">View on GitHub</a>
<div class="sourceCode" id="cb42"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span><span class="op">*;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span><span class="op">*;</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> results <span class="op">=</span> posts</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>filter(published<span class="op">.</span>eq(<span class="cn">true</span>))</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>limit(<span class="dv">5</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>select(<span class="pp">Post::</span>as_select())</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>load(connection)</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Error loading posts&quot;</span>)<span class="op">;</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;Displaying {} posts&quot;</span><span class="op">,</span> results<span class="op">.</span>len())<span class="op">;</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> post <span class="kw">in</span> results <span class="op">{</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="pp">println!</span>(<span class="st">&quot;{}&quot;</span><span class="op">,</span> post<span class="op">.</span>title)<span class="op">;</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>        <span class="pp">println!</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="op">;</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>        <span class="pp">println!</span>(<span class="st">&quot;{}&quot;</span><span class="op">,</span> post<span class="op">.</span>body)<span class="op">;</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/show_posts.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_1/src/bin/show_posts.rs">View on GitHub</a>
<div class="sourceCode" id="cb43"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span><span class="op">*;</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span><span class="op">*;</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> results <span class="op">=</span> posts</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>filter(published<span class="op">.</span>eq(<span class="cn">true</span>))</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>limit(<span class="dv">5</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>select(<span class="pp">Post::</span>as_select())</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>load(connection)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Error loading posts&quot;</span>)<span class="op">;</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;Displaying {} posts&quot;</span><span class="op">,</span> results<span class="op">.</span>len())<span class="op">;</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> post <span class="kw">in</span> results <span class="op">{</span></span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>        <span class="pp">println!</span>(<span class="st">&quot;{}&quot;</span><span class="op">,</span> post<span class="op">.</span>title)<span class="op">;</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>        <span class="pp">println!</span>(<span class="st">&quot;-----------</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="op">;</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>        <span class="pp">println!</span>(<span class="st">&quot;{}&quot;</span><span class="op">,</span> post<span class="op">.</span>body)<span class="op">;</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<p>The use <code>self::schema::posts::dsl::*</code> line imports a bunch
of aliases so that we can say <code>posts</code> instead of
<code>posts::table</code>, and <code>published</code> instead of
<code>posts::published</code>. It’s useful when we’re only dealing with
a single table, but that’s not always what we want. It’s always
important to keep imports to <code>schema::table::dsl::*</code> inside
of the current function to prevent polluting the module namespace.</p>
<p>We can run our script with <code>cargo run --bin show_posts</code>.
Unfortunately, the results won’t be terribly interesting, as we don’t
actually have any posts in the database. Still, we’ve written a decent
amount of code, so let’s commit.</p>
<p>The full code for the demo at this point can be found here for <a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples/postgres/getting_started_step_1/">PostgreSQL</a>,
<a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples/sqlite/getting_started_step_1">SQLite</a>
and <a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples/mysql/getting_started_step_1">MySQL</a>.</p>
<p>Next, let’s write some code to create a new post. We’ll want a struct
to use for inserting a new record.</p>
<div>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/models.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_2/src/models.rs">View on GitHub</a>
<div class="sourceCode" id="cb44"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">crate</span><span class="pp">::schema::</span>posts<span class="op">;</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>derive<span class="at">(</span>Insertable<span class="at">)]</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>diesel<span class="at">(</span>table_name <span class="op">=</span> posts<span class="at">)]</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">struct</span> NewPost<span class="op">&lt;</span><span class="ot">&#39;a</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> title<span class="op">:</span> <span class="op">&amp;</span><span class="ot">&#39;a</span> <span class="dt">str</span><span class="op">,</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> body<span class="op">:</span> <span class="op">&amp;</span><span class="ot">&#39;a</span> <span class="dt">str</span><span class="op">,</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/models.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_2/src/models.rs">View on GitHub</a>
<div class="sourceCode" id="cb45"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">crate</span><span class="pp">::schema::</span>posts<span class="op">;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>derive<span class="at">(</span>Insertable<span class="at">)]</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>diesel<span class="at">(</span>table_name <span class="op">=</span> posts<span class="at">)]</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">struct</span> NewPost<span class="op">&lt;</span><span class="ot">&#39;a</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> title<span class="op">:</span> <span class="op">&amp;</span><span class="ot">&#39;a</span> <span class="dt">str</span><span class="op">,</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> body<span class="op">:</span> <span class="op">&amp;</span><span class="ot">&#39;a</span> <span class="dt">str</span><span class="op">,</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/models.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_2/src/models.rs">View on GitHub</a>
<div class="sourceCode" id="cb46"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">crate</span><span class="pp">::schema::</span>posts<span class="op">;</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>derive<span class="at">(</span>Insertable<span class="at">)]</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>diesel<span class="at">(</span>table_name <span class="op">=</span> posts<span class="at">)]</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">struct</span> NewPost<span class="op">&lt;</span><span class="ot">&#39;a</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> title<span class="op">:</span> <span class="op">&amp;</span><span class="ot">&#39;a</span> <span class="dt">str</span><span class="op">,</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">pub</span> body<span class="op">:</span> <span class="op">&amp;</span><span class="ot">&#39;a</span> <span class="dt">str</span><span class="op">,</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<p>Now let’s add a function to save a new post.</p>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/lib.rs
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_2/src/lib.rs">View on GitHub</a>
<div class="sourceCode" id="cb47"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span><span class="op">{</span>NewPost<span class="op">,</span> Post<span class="op">};</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">fn</span> create_post(conn<span class="op">:</span> <span class="op">&amp;</span><span class="kw">mut</span> PgConnection<span class="op">,</span> title<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span><span class="op">,</span> body<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span>) <span class="op">-&gt;</span> Post <span class="op">{</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">crate</span><span class="pp">::schema::</span>posts<span class="op">;</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> new_post <span class="op">=</span> NewPost <span class="op">{</span> title<span class="op">,</span> body <span class="op">};</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="pp">diesel::</span>insert_into(<span class="pp">posts::</span>table)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>values(<span class="op">&amp;</span>new_post)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>returning(<span class="pp">Post::</span>as_returning())</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>get_result(conn)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Error saving new post&quot;</span>)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/lib.rs
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_2/src/lib.rs">View on GitHub</a>
<div class="sourceCode" id="cb48"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span><span class="op">{</span>NewPost<span class="op">,</span> Post<span class="op">};</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">fn</span> create_post(conn<span class="op">:</span> <span class="op">&amp;</span><span class="kw">mut</span> SqliteConnection<span class="op">,</span> title<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span><span class="op">,</span> body<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span>) <span class="op">-&gt;</span> Post <span class="op">{</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">crate</span><span class="pp">::schema::</span>posts<span class="op">;</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> new_post <span class="op">=</span> NewPost <span class="op">{</span> title<span class="op">,</span> body <span class="op">};</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="pp">diesel::</span>insert_into(<span class="pp">posts::</span>table)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>values(<span class="op">&amp;</span>new_post)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>returning(<span class="pp">Post::</span>as_returning())</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>get_result(conn)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Error saving new post&quot;</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/lib.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_2/src/lib.rs">View on GitHub</a>
<div class="sourceCode" id="cb49"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span><span class="op">{</span>NewPost<span class="op">,</span> Post<span class="op">};</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="kw">pub</span> <span class="kw">fn</span> create_post(conn<span class="op">:</span> <span class="op">&amp;</span><span class="kw">mut</span> MysqlConnection<span class="op">,</span> title<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span><span class="op">,</span> body<span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span>) <span class="op">-&gt;</span> Post <span class="op">{</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">crate</span><span class="pp">::schema::</span>posts<span class="op">;</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> new_post <span class="op">=</span> NewPost <span class="op">{</span> title<span class="op">,</span> body <span class="op">};</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    conn<span class="op">.</span>transaction(<span class="op">|</span>conn<span class="op">|</span> <span class="op">{</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>        <span class="pp">diesel::</span>insert_into(<span class="pp">posts::</span>table)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span>values(<span class="op">&amp;</span>new_post)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span>execute(conn)<span class="op">?;</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>        <span class="pp">posts::</span>table</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span>order(<span class="pp">posts::</span>id<span class="op">.</span>desc())</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span>select(<span class="pp">Post::</span>as_select())</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span>first(conn)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span>expect(<span class="st">&quot;Error while saving post&quot;</span>)</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<p>When we call <a
href="https://docs.diesel.rs/2.3.x/diesel/prelude/trait.RunQueryDsl.html#method.get_result"><code>.get_result</code></a>
on an insert or update statement, it automatically adds
<code>RETURNING *</code> to the end of the query, and lets us load it
into any struct that implements <code>Queryable</code> for the right
types. Neat!</p>
<aside class="aside aside--note">
<header class="aside__header">
A Note on <code>RETURNING</code> clauses
</header>
<div class="aside__text">
<p>Not all databases support <code>RETURNING</code> clauses. On backends
that support the RETURNING clause (such as PostgreSQL and SQLite), we
can get data back from our insert as well. On the SQLite backend, <a
href="https://www.sqlite.org/lang_returning.html"
target="_blank">RETURNING</a> has been supported since version 3.35.0.
To enable RETURNING clause add feature flag,
<code>returning_clauses_for_sqlite_3_35</code> in
<code>Cargo.toml</code>:</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode toml"><code class="sourceCode toml"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="dt">diesel</span> <span class="op">=</span> <span class="op">{ </span><span class="dt">version</span><span class="op"> =</span> <span class="st">&quot;2.2.0&quot;</span><span class="op">, </span><span class="dt">features</span><span class="op"> =</span> <span class="op">[</span><span class="st">&quot;sqlite&quot;</span><span class="op">,</span> <span class="st">&quot;returning_clauses_for_sqlite_3_35&quot;</span><span class="op">]</span></span></code></pre></div>
<p>MySQL does not support RETURNING clauses. To get back all of the
inserted rows, we can call <code>.get_results</code> instead of
<code>.execute</code>. If you follow this guide on a different database
system be sure to checkout <a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples"
target="_blank">the examples specific to your database system</a>.</p>
</div>
</aside>
<p>Diesel can insert more than one record in a single query. Just pass a
<code>Vec</code> or slice to <a
href="https://docs.diesel.rs/2.3.x/diesel/fn.insert_into.html"><code>insert_into</code></a>,
and then call <a
href="https://docs.diesel.rs/2.3.x/diesel/prelude/trait.RunQueryDsl.html#method.get_results"><code>get_results</code></a>
instead of <code>get_result</code>. If you don’t actually want to do
anything with the row that was just inserted, call <a
href="https://docs.diesel.rs/2.3.x/diesel/prelude/trait.RunQueryDsl.html#method.execute"><code>.execute</code></a>
instead. The compiler won’t complain at you, that way. :)</p>
<p>Now that we’ve got everything set up, we can create a little script
to write a new post.</p>
<div>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/write_post.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_2/src/bin/write_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb51"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::io::</span><span class="op">{</span>stdin<span class="op">,</span> <span class="bu">Read</span><span class="op">};</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> title <span class="op">=</span> <span class="dt">String</span><span class="pp">::</span>new()<span class="op">;</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> body <span class="op">=</span> <span class="dt">String</span><span class="pp">::</span>new()<span class="op">;</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;What would you like your title to be?&quot;</span>)<span class="op">;</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    stdin()<span class="op">.</span>read_line(<span class="op">&amp;</span><span class="kw">mut</span> title)<span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> title <span class="op">=</span> title<span class="op">.</span>trim_end()<span class="op">;</span> <span class="co">// Remove the trailing newline</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Ok! Let&#39;s write {title} (Press {EOF} when finished)</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>)<span class="op">;</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    stdin()<span class="op">.</span>read_to_string(<span class="op">&amp;</span><span class="kw">mut</span> body)<span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post <span class="op">=</span> create_post(connection<span class="op">,</span> title<span class="op">,</span> <span class="op">&amp;</span>body)<span class="op">;</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Saved draft {title} with id {}&quot;</span><span class="op">,</span> post<span class="op">.</span>id)<span class="op">;</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>cfg<span class="at">(</span>not<span class="at">(</span>windows<span class="at">))]</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> <span class="cn">EOF</span><span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span> <span class="op">=</span> <span class="st">&quot;CTRL+D&quot;</span><span class="op">;</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>cfg<span class="at">(</span>windows<span class="at">)]</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> <span class="cn">EOF</span><span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span> <span class="op">=</span> <span class="st">&quot;CTRL+Z&quot;</span><span class="op">;</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/write_post.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_2/src/bin/write_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb52"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::io::</span><span class="op">{</span>stdin<span class="op">,</span> <span class="bu">Read</span><span class="op">};</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> title <span class="op">=</span> <span class="dt">String</span><span class="pp">::</span>new()<span class="op">;</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> body <span class="op">=</span> <span class="dt">String</span><span class="pp">::</span>new()<span class="op">;</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;What would you like your title to be?&quot;</span>)<span class="op">;</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    stdin()<span class="op">.</span>read_line(<span class="op">&amp;</span><span class="kw">mut</span> title)<span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> title <span class="op">=</span> title<span class="op">.</span>trim_end()<span class="op">;</span> <span class="co">// Remove the trailing newline</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Ok! Let&#39;s write {title} (Press {EOF} when finished)</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>)<span class="op">;</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    stdin()<span class="op">.</span>read_to_string(<span class="op">&amp;</span><span class="kw">mut</span> body)<span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post <span class="op">=</span> create_post(connection<span class="op">,</span> title<span class="op">,</span> <span class="op">&amp;</span>body)<span class="op">;</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Saved draft {title} with id {}&quot;</span><span class="op">,</span> post<span class="op">.</span>id)<span class="op">;</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>cfg<span class="at">(</span>not<span class="at">(</span>windows<span class="at">))]</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> <span class="cn">EOF</span><span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span> <span class="op">=</span> <span class="st">&quot;CTRL+D&quot;</span><span class="op">;</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>cfg<span class="at">(</span>windows<span class="at">)]</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> <span class="cn">EOF</span><span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span> <span class="op">=</span> <span class="st">&quot;CTRL+Z&quot;</span><span class="op">;</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/write_post.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_2/src/bin/write_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb53"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::io::</span><span class="op">{</span>stdin<span class="op">,</span> <span class="bu">Read</span><span class="op">};</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> title <span class="op">=</span> <span class="dt">String</span><span class="pp">::</span>new()<span class="op">;</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> <span class="kw">mut</span> body <span class="op">=</span> <span class="dt">String</span><span class="pp">::</span>new()<span class="op">;</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;What would you like your title to be?&quot;</span>)<span class="op">;</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    stdin()<span class="op">.</span>read_line(<span class="op">&amp;</span><span class="kw">mut</span> title)<span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> title <span class="op">=</span> title<span class="op">.</span>trim_end()<span class="op">;</span> <span class="co">// Remove the trailing newline</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Ok! Let&#39;s write {title} (Press {EOF} when finished)</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">,</span>)<span class="op">;</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    stdin()<span class="op">.</span>read_to_string(<span class="op">&amp;</span><span class="kw">mut</span> body)<span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post <span class="op">=</span> create_post(connection<span class="op">,</span> title<span class="op">,</span> <span class="op">&amp;</span>body)<span class="op">;</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">Saved draft {title} with id {}&quot;</span><span class="op">,</span> post<span class="op">.</span>id)<span class="op">;</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>cfg<span class="at">(</span>not<span class="at">(</span>windows<span class="at">))]</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> <span class="cn">EOF</span><span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span> <span class="op">=</span> <span class="st">&quot;CTRL+D&quot;</span><span class="op">;</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="at">#[</span>cfg<span class="at">(</span>windows<span class="at">)]</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> <span class="cn">EOF</span><span class="op">:</span> <span class="op">&amp;</span><span class="dt">str</span> <span class="op">=</span> <span class="st">&quot;CTRL+Z&quot;</span><span class="op">;</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<p>We can run our new script with
<code>cargo run --bin write_post</code>. Go ahead and write a blog post.
Get creative! Here was mine:</p>
<pre><code>   Compiling diesel_demo v0.1.0 (file:///Users/sean/Documents/Projects/open-source/diesel_demo)
     Running `target/debug/write_post`

What would you like your title to be?
Diesel demo

Ok! Let&#39;s write Diesel demo (Press CTRL+D when finished)

You know, a CLI application probably isn&#39;t the best interface for a blog demo.
But really I just wanted a semi-simple example, where I could focus on Diesel.
I didn&#39;t want to get bogged down in some web framework here.

Saved draft Diesel demo with id 1</code></pre>
<p>Unfortunately, running <code>show_posts</code> still won’t display
our new post, because we saved it as a draft. If we look back to the
code in <code>show_posts</code>, we added <a
href="https://docs.diesel.rs/2.3.x/diesel/prelude/trait.QueryDsl.html#method.filter"><code>.filter(published.eq(true))</code></a>,
and we had <code>published</code> default to false in our migration. We
need to publish it! But in order to do that, we’ll need to look at how
to update an existing record. First, let’s commit. The code for this
demo at this point can be found here for <a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples/postgres/getting_started_step_2/">PostgreSQL</a>,
<a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples/sqlite/getting_started_step_2/">SQLite</a>,
and <a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples/mysql/getting_started_step_2/">MySQL</a>.</p>
<p>Now that we’ve got create and read out of the way, update is actually
relatively simple. Let’s jump right into the script:</p>
<div>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/publish_post.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_3/src/bin/publish_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb55"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span>Post<span class="op">;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::env::</span>args<span class="op">;</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span><span class="op">{</span>posts<span class="op">,</span> published<span class="op">};</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> id <span class="op">=</span> args()</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>nth(<span class="dv">1</span>)</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;publish_post requires a post id&quot;</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="pp">parse::</span><span class="op">&lt;</span><span class="dt">i32</span><span class="op">&gt;</span>()</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Invalid ID&quot;</span>)<span class="op">;</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post <span class="op">=</span> <span class="pp">diesel::</span>update(posts<span class="op">.</span>find(id))</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>set(published<span class="op">.</span>eq(<span class="cn">true</span>))</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>returning(<span class="pp">Post::</span>as_returning())</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>get_result(connection)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;Published post {}&quot;</span><span class="op">,</span> post<span class="op">.</span>title)<span class="op">;</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/publish_post.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_3/src/bin/publish_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb56"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span>Post<span class="op">;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::env::</span>args<span class="op">;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span><span class="op">{</span>posts<span class="op">,</span> published<span class="op">};</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> id <span class="op">=</span> args()</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>nth(<span class="dv">1</span>)</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;publish_post requires a post id&quot;</span>)</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="pp">parse::</span><span class="op">&lt;</span><span class="dt">i32</span><span class="op">&gt;</span>()</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Invalid ID&quot;</span>)<span class="op">;</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post <span class="op">=</span> <span class="pp">diesel::</span>update(posts<span class="op">.</span>find(id))</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>set(published<span class="op">.</span>eq(<span class="cn">true</span>))</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>returning(<span class="pp">Post::</span>as_returning())</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>get_result(connection)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>unwrap()<span class="op">;</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;Published post {}&quot;</span><span class="op">,</span> post<span class="op">.</span>title)<span class="op">;</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/publish_post.rs
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_3/src/bin/publish_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb57"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span>Post<span class="op">;</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::env::</span>args<span class="op">;</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span><span class="op">{</span>posts<span class="op">,</span> published<span class="op">};</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> id <span class="op">=</span> args()</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>nth(<span class="dv">1</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;publish_post requires a post id&quot;</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="pp">parse::</span><span class="op">&lt;</span><span class="dt">i32</span><span class="op">&gt;</span>()</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Invalid ID&quot;</span>)<span class="op">;</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post <span class="op">=</span> connection</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>transaction(<span class="op">|</span>connection<span class="op">|</span> <span class="op">{</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> post <span class="op">=</span> posts<span class="op">.</span>find(id)<span class="op">.</span>select(<span class="pp">Post::</span>as_select())<span class="op">.</span>first(connection)<span class="op">?;</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>            <span class="pp">diesel::</span>update(posts<span class="op">.</span>find(id))</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span>set(published<span class="op">.</span>eq(<span class="cn">true</span>))</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span>execute(connection)<span class="op">?;</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>            <span class="cn">Ok</span>(post)</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span>)</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>unwrap_or_else(<span class="op">|</span>_<span class="op">:</span> <span class="pp">diesel::result::</span><span class="bu">Error</span><span class="op">|</span> <span class="pp">panic!</span>(<span class="st">&quot;Unable to find post {}&quot;</span><span class="op">,</span> id))<span class="op">;</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;Published post {}&quot;</span><span class="op">,</span> post<span class="op">.</span>title)<span class="op">;</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<p>That’s it! Let’s try it out with
<code>cargo run --bin publish_post 1</code>.</p>
<pre><code> Compiling diesel_demo v0.1.0 (file:///Users/sean/Documents/Projects/open-source/diesel_demo)
   Running `target/debug/publish_post 1`
Published post Diesel demo</code></pre>
<p>Additionally, let’s implement a possibility of fetching a single
post. We will display the post id with its title. Notice the <a
href="https://docs.diesel.rs/2.3.x/diesel/result/trait.OptionalExtension.html#tymethod.optional"><code>.optional()</code></a>
call. This returns <code>Option&lt;Post&gt;</code> instead of throwing
an error, which we can then use in our matching pattern. For additional
methods to modify the constructed select statements refer to the <a
href="https://docs.diesel.rs/2.3.x/diesel/query_dsl/trait.QueryDsl.html"><code>documentation</code>
of <code>QueryDsl</code></a></p>
<div>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/get_post.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_3/src/bin/get_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb59"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span>Post<span class="op">;</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::env::</span>args<span class="op">;</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span>posts<span class="op">;</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post_id <span class="op">=</span> args()</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>nth(<span class="dv">1</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;get_post requires a post id&quot;</span>)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="pp">parse::</span><span class="op">&lt;</span><span class="dt">i32</span><span class="op">&gt;</span>()</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Invalid ID&quot;</span>)<span class="op">;</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post <span class="op">=</span> posts</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>find(post_id)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>select(<span class="pp">Post::</span>as_select())</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>first(connection)</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>optional()<span class="op">;</span> <span class="co">// This allows for returning an Option&lt;Post&gt;, otherwise it will throw an error</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">match</span> post <span class="op">{</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>        <span class="cn">Ok</span>(<span class="cn">Some</span>(post)) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;Post with id: {} has a title: {}&quot;</span><span class="op">,</span> post<span class="op">.</span>id<span class="op">,</span> post<span class="op">.</span>title)<span class="op">,</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>        <span class="cn">Ok</span>(<span class="cn">None</span>) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;Unable to find post {}&quot;</span><span class="op">,</span> post_id)<span class="op">,</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>        <span class="cn">Err</span>(_) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;An error occured while fetching post {}&quot;</span><span class="op">,</span> post_id)<span class="op">,</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/get_post.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_3/src/bin/get_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb60"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span>Post<span class="op">;</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::env::</span>args<span class="op">;</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span>posts<span class="op">;</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post_id <span class="op">=</span> args()</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>nth(<span class="dv">1</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;get_post requires a post id&quot;</span>)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="pp">parse::</span><span class="op">&lt;</span><span class="dt">i32</span><span class="op">&gt;</span>()</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Invalid ID&quot;</span>)<span class="op">;</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post <span class="op">=</span> posts</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>find(post_id)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>select(<span class="pp">Post::</span>as_select())</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>first(connection)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>optional()<span class="op">;</span> <span class="co">// This allows for returning an Option&lt;Post&gt;, otherwise it will throw an error</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">match</span> post <span class="op">{</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>        <span class="cn">Ok</span>(<span class="cn">Some</span>(post)) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;Post with id: {} has a title: {}&quot;</span><span class="op">,</span> post<span class="op">.</span>id<span class="op">,</span> post<span class="op">.</span>title)<span class="op">,</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>        <span class="cn">Ok</span>(<span class="cn">None</span>) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;Unable to find post {}&quot;</span><span class="op">,</span> post_id)<span class="op">,</span></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>        <span class="cn">Err</span>(_) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;An error occured while fetching post {}&quot;</span><span class="op">,</span> post_id)<span class="op">,</span></span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/get_post.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_3/src/bin/get_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb61"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="kw">self</span><span class="pp">::models::</span>Post<span class="op">;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::env::</span>args<span class="op">;</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span>posts<span class="op">;</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post_id <span class="op">=</span> args()</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>nth(<span class="dv">1</span>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;get_post requires a post id&quot;</span>)</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span><span class="pp">parse::</span><span class="op">&lt;</span><span class="dt">i32</span><span class="op">&gt;</span>()</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Invalid ID&quot;</span>)<span class="op">;</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> post <span class="op">=</span> posts</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>find(post_id)</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>select(<span class="pp">Post::</span>as_select())</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>first(connection)</span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>optional()<span class="op">;</span> <span class="co">// This allows for returning an Option&lt;Post&gt;, otherwise it will throw an error</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">match</span> post <span class="op">{</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>        <span class="cn">Ok</span>(<span class="cn">Some</span>(post)) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;Post with id: {} has a title: {}&quot;</span><span class="op">,</span> post<span class="op">.</span>id<span class="op">,</span> post<span class="op">.</span>title)<span class="op">,</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>        <span class="cn">Ok</span>(<span class="cn">None</span>) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;Unable to find post {}&quot;</span><span class="op">,</span> post_id)<span class="op">,</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>        <span class="cn">Err</span>(_) <span class="op">=&gt;</span> <span class="pp">println!</span>(<span class="st">&quot;An error occured while fetching post {}&quot;</span><span class="op">,</span> post_id)<span class="op">,</span></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<p>We can see our post with <code>cargo run --bin get_post 1</code>.</p>
<pre><code> Compiling diesel_demo v0.1.0 (file:///Users/sean/Documents/Projects/open-source/diesel_demo)
   Running `target/debug/get_post 1`
   Post with id: 1 has a title: Diesel demo</code></pre>
<p>And now, finally, we can see our post with
<code>cargo run --bin show_posts</code>.</p>
<pre><code>     Running `target/debug/show_posts`
Displaying 1 posts
Diesel demo
----------

You know, a CLI application probably isn&#39;t the best interface for a blog demo.
But really I just wanted a semi-simple example, where I could focus on Diesel.
I didn&#39;t want to get bogged down in some web framework here.</code></pre>
<p>We’ve still only covered three of the four letters of CRUD though.
Let’s show how to delete things. Sometimes we write something we really
hate, and we don’t have time to look up the ID. So let’s delete based on
the title, or even just some words in the title.</p>
<div>
<div class="postgres-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/delete_post.rs (PostgreSQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/postgres/getting_started_step_3/src/bin/delete_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb64"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::env::</span>args<span class="op">;</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span><span class="op">*;</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> target <span class="op">=</span> args()<span class="op">.</span>nth(<span class="dv">1</span>)<span class="op">.</span>expect(<span class="st">&quot;Expected a target to match against&quot;</span>)<span class="op">;</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> pattern <span class="op">=</span> <span class="pp">format!</span>(<span class="st">&quot;%{}%&quot;</span><span class="op">,</span> target)<span class="op">;</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> num_deleted <span class="op">=</span> <span class="pp">diesel::</span>delete(posts<span class="op">.</span>filter(title<span class="op">.</span>like(pattern)))</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>execute(connection)</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Error deleting posts&quot;</span>)<span class="op">;</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;Deleted {} posts&quot;</span><span class="op">,</span> num_deleted)<span class="op">;</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="sqlite-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/delete_post.rs (SQLite)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/sqlite/getting_started_step_3/src/bin/delete_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb65"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::env::</span>args<span class="op">;</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span><span class="op">*;</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> target <span class="op">=</span> args()<span class="op">.</span>nth(<span class="dv">1</span>)<span class="op">.</span>expect(<span class="st">&quot;Expected a target to match against&quot;</span>)<span class="op">;</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> pattern <span class="op">=</span> <span class="pp">format!</span>(<span class="st">&quot;%{}%&quot;</span><span class="op">,</span> target)<span class="op">;</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> num_deleted <span class="op">=</span> <span class="pp">diesel::</span>delete(posts<span class="op">.</span>filter(title<span class="op">.</span>like(pattern)))</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>execute(connection)</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Error deleting posts&quot;</span>)<span class="op">;</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;Deleted {} posts&quot;</span><span class="op">,</span> num_deleted)<span class="op">;</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
<div class="mysql-example">
<div class="demo__example">
<div class="demo__example-browser">
<div class="browser-bar">
src/bin/delete_post.rs (MySQL)
</div>
<a class = "btn-demo-example" href = "https://github.com/diesel-rs/diesel/blob/2.3.x/examples/mysql/getting_started_step_3/src/bin/delete_post.rs">View on GitHub</a>
<div class="sourceCode" id="cb66"><pre
class="sourceCode rust"><code class="sourceCode rust"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel::prelude::</span><span class="op">*;</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">diesel_demo::</span><span class="op">*;</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="kw">use</span> <span class="pp">std::env::</span>args<span class="op">;</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="kw">fn</span> main() <span class="op">{</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">use</span> <span class="kw">self</span><span class="pp">::schema::posts::dsl::</span><span class="op">*;</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> target <span class="op">=</span> args()<span class="op">.</span>nth(<span class="dv">1</span>)<span class="op">.</span>expect(<span class="st">&quot;Expected a target to match against&quot;</span>)<span class="op">;</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> pattern <span class="op">=</span> <span class="pp">format!</span>(<span class="st">&quot;%{}%&quot;</span><span class="op">,</span> target)<span class="op">;</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> connection <span class="op">=</span> <span class="op">&amp;</span><span class="kw">mut</span> establish_connection()<span class="op">;</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> num_deleted <span class="op">=</span> <span class="pp">diesel::</span>delete(posts<span class="op">.</span>filter(title<span class="op">.</span>like(pattern)))</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>execute(connection)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">.</span>expect(<span class="st">&quot;Error deleting posts&quot;</span>)<span class="op">;</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    <span class="pp">println!</span>(<span class="st">&quot;Deleted {} posts&quot;</span><span class="op">,</span> num_deleted)<span class="op">;</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<p>We can run the script with
<code>cargo run --bin delete_post demo</code> (at least with the title I
chose). Your output should look something like:</p>
<pre><code>   Compiling diesel_demo v0.1.0 (file:///Users/sean/Documents/Projects/open-source/diesel_demo)
     Running `target/debug/delete_post demo`
Deleted 1 posts</code></pre>
<p>When we try to run <code>cargo run --bin show_posts</code> again, we
can see that the post was in fact deleted. This barely scratches the
surface of what you can do with Diesel, but hopefully this tutorial has
given you a good foundation to build off of. We recommend exploring the
<a href="https://docs.diesel.rs/2.3.x/diesel/index.html">API docs</a> to
see more. The final code for this tutorial can be found here for <a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples/postgres/getting_started_step_3/">PostgreSQL</a>,
<a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples/sqlite/getting_started_step_3/">SQLite</a>,
and <a
href="https://github.com/diesel-rs/diesel/tree/2.3.x/examples/mysql/getting_started_step_3/">MySQL</a>.</p>
</div>
</div>
</div>
<script src="../assets/javascripts/application.js"></script>
    </main>
<footer>
    <div class="content-wrapper">
        <p> Found a mistake on this website? Submit an issue or send a pull request
            <a href = "https://github.com/sgrif/diesel.rs-website">here</a>! </p>
        <p></p>
        <br/>
        <p>Copyright © 2015-2025 The Diesel Core Team</p>
    </div>
</footer>
<script type="text/javascript">

</script>
<script defer src="https://umami.weiznich.de/script.js" data-website-id="cbfc6769-b0b4-4256-9fbc-f5c053b55bed"></script>
</body>
</html>
