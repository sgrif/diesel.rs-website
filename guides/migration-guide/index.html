<!DOCTYPE html><html lang="en" dir="ltr" data-theme="dark" data-has-toc data-has-sidebar class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Diesel 2.0 migration guide | DIESEL</title><link rel="canonical" href="https://diesel.rs/guides/migration-guide/"/><link rel="sitemap" href="/sitemap-index.xml"/><link rel="shortcut icon" href="/images/diesel_logo_favicon_32.png" type="image/png"/><meta name="generator" content="Astro v5.16.11"/><meta name="generator" content="Starlight v0.37.3"/><meta property="og:title" content="Diesel 2.0 migration guide"/><meta property="og:type" content="article"/><meta property="og:url" content="https://diesel.rs/guides/migration-guide/"/><meta property="og:locale" content="en"/><meta property="og:site_name" content="DIESEL"/><meta name="twitter:card" content="summary_large_image"/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg><svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg><svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg></template> <script>
	// Set dark theme as default on initial load
	if (!localStorage.getItem('starlight-theme')) {
		document.documentElement.dataset.theme = 'dark';
		localStorage.setItem('starlight-theme', 'dark');
	}
</script><link rel="stylesheet" href="/static/print-DNXP8c50.css" media="print"><link rel="stylesheet" href="/static/index-CuDomZ0o.css">
<style>@layer starlight.components{:root{--sl-badge-default-border: var(--sl-color-accent);--sl-badge-default-bg: var(--sl-color-accent-low);--sl-badge-default-text: #fff;--sl-badge-note-border: var(--sl-color-blue);--sl-badge-note-bg: var(--sl-color-blue-low);--sl-badge-note-text: #fff;--sl-badge-danger-border: var(--sl-color-red);--sl-badge-danger-bg: var(--sl-color-red-low);--sl-badge-danger-text: #fff;--sl-badge-success-border: var(--sl-color-green);--sl-badge-success-bg: var(--sl-color-green-low);--sl-badge-success-text: #fff;--sl-badge-caution-border: var(--sl-color-orange);--sl-badge-caution-bg: var(--sl-color-orange-low);--sl-badge-caution-text: #fff;--sl-badge-tip-border: var(--sl-color-purple);--sl-badge-tip-bg: var(--sl-color-purple-low);--sl-badge-tip-text: #fff}[data-theme=light]:root{--sl-badge-default-bg: var(--sl-color-accent-high);--sl-badge-note-bg: var(--sl-color-blue-high);--sl-badge-danger-bg: var(--sl-color-red-high);--sl-badge-success-bg: var(--sl-color-green-high);--sl-badge-caution-bg: var(--sl-color-orange-high);--sl-badge-tip-bg: var(--sl-color-purple-high)}.sl-badge:where(.astro-avdet4wd){display:inline-block;border:1px solid var(--sl-color-border-badge);border-radius:.25rem;font-family:var(--sl-font-system-mono);line-height:normal;color:var(--sl-color-text-badge);background-color:var(--sl-color-bg-badge);overflow-wrap:anywhere}.sidebar-content .sl-badge:where(.astro-avdet4wd){line-height:1;font-size:var(--sl-text-xs);padding:.125rem .375rem}.sidebar-content a[aria-current=page]>.sl-badge:where(.astro-avdet4wd){--sl-color-bg-badge: transparent;--sl-color-border-badge: currentColor;color:inherit}.default:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-default-bg);--sl-color-border-badge: var(--sl-badge-default-border);--sl-color-text-badge: var(--sl-badge-default-text)}.note:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-note-bg);--sl-color-border-badge: var(--sl-badge-note-border);--sl-color-text-badge: var(--sl-badge-note-text)}.danger:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-danger-bg);--sl-color-border-badge: var(--sl-badge-danger-border);--sl-color-text-badge: var(--sl-badge-danger-text)}.success:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-success-bg);--sl-color-border-badge: var(--sl-badge-success-border);--sl-color-text-badge: var(--sl-badge-success-text)}.tip:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-tip-bg);--sl-color-border-badge: var(--sl-badge-tip-border);--sl-color-text-badge: var(--sl-badge-tip-text)}.caution:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-caution-bg);--sl-color-border-badge: var(--sl-badge-caution-border);--sl-color-text-badge: var(--sl-badge-caution-text)}.small:where(.astro-avdet4wd){font-size:var(--sl-text-xs);padding:.125rem .25rem}.medium:where(.astro-avdet4wd){font-size:var(--sl-text-sm);padding:.175rem .35rem}.large:where(.astro-avdet4wd){font-size:var(--sl-text-base);padding:.225rem .45rem}.sl-markdown-content :is(h1,h2,h3,h4,h5,h6) .sl-badge:where(.astro-avdet4wd){vertical-align:middle}}
@layer starlight.components{.card-grid:where(.astro-zntqmydn){display:grid;grid-template-columns:100%;gap:1rem}.card-grid:where(.astro-zntqmydn)>*{margin-top:0!important}@media(min-width:50rem){.card-grid:where(.astro-zntqmydn){grid-template-columns:1fr 1fr;gap:1.5rem}.stagger:where(.astro-zntqmydn){--stagger-height: 5rem;padding-bottom:var(--stagger-height)}.stagger:where(.astro-zntqmydn)>*:nth-child(2n){transform:translateY(var(--stagger-height))}}}
@layer starlight.components{svg:where(.astro-c6vsoqas){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);width:1em;height:1em}}
@layer starlight.components{starlight-tabs:where(.astro-esqgolmp){display:block}.tablist-wrapper:where(.astro-esqgolmp){overflow-x:auto}:where(.astro-esqgolmp)[role=tablist]{display:flex;list-style:none;border-bottom:2px solid var(--sl-color-gray-5);padding:0}.tab:where(.astro-esqgolmp){display:flex}.tab:where(.astro-esqgolmp)>:where(.astro-esqgolmp)[role=tab]{--sl-tab-color-border: var(--sl-color-gray-5);display:flex;align-items:center;gap:.5rem;line-height:var(--sl-line-height-headings);padding:.275rem 1.25rem;text-decoration:none;box-shadow:0 2px 0 var(--sl-tab-color-border);color:var(--sl-color-gray-3);outline-offset:var(--sl-outline-offset-inside);overflow-wrap:initial}.tab:where(.astro-esqgolmp) :where(.astro-esqgolmp)[role=tab][aria-selected=true]{--sl-tab-color-border: var(--sl-color-text-accent);color:var(--sl-color-white);font-weight:600}.tablist-wrapper:where(.astro-esqgolmp)~[role=tabpanel]{margin-top:1rem}}
@layer starlight.components{.sl-steps{--bullet-size: calc(var(--sl-line-height) * 1rem);--bullet-margin: .375rem;list-style:none;counter-reset:steps-counter var(--sl-steps-start, 0);padding-inline-start:0}.sl-steps>li{counter-increment:steps-counter;position:relative;padding-inline-start:calc(var(--bullet-size) + 1rem);padding-bottom:1px;min-height:calc(var(--bullet-size) + var(--bullet-margin))}.sl-steps>li+li{margin-top:0}.sl-steps>li:before{content:counter(steps-counter);position:absolute;top:0;inset-inline-start:0;width:var(--bullet-size);height:var(--bullet-size);line-height:var(--bullet-size);font-size:var(--sl-text-xs);font-weight:600;text-align:center;color:var(--sl-color-white);background-color:var(--sl-color-gray-6);border-radius:99rem;box-shadow:inset 0 0 0 1px var(--sl-color-gray-5)}.sl-steps>li:after{--guide-width: 1px;content:"";position:absolute;top:calc(var(--bullet-size) + var(--bullet-margin));bottom:var(--bullet-margin);inset-inline-start:calc((var(--bullet-size) - var(--guide-width)) / 2);width:var(--guide-width);background-color:var(--sl-color-hairline-light)}}@layer starlight.content{.sl-steps>li>:first-child{--lh: calc(1em * var(--sl-line-height));--shift-y: calc(.5 * (var(--bullet-size) - var(--lh)));transform:translateY(var(--shift-y));margin-bottom:var(--shift-y)}.sl-steps>li>:first-child:where(h1,h2,h3,h4,h5,h6){--lh: calc(1em * var(--sl-line-height-headings))}@supports (--prop: 1lh){.sl-steps>li>:first-child{--lh: 1lh}}}
@layer starlight.components{.sl-link-button:where(.astro-xwgiixxa){align-items:center;border:1px solid transparent;border-radius:999rem;display:inline-flex;font-size:var(--sl-text-sm);gap:.5em;line-height:1.1875;outline-offset:.25rem;padding:.4375rem 1.125rem;text-decoration:none}.sl-link-button:where(.astro-xwgiixxa).primary{background:var(--sl-color-text-accent);border-color:var(--sl-color-text-accent);color:var(--sl-color-black)}.sl-link-button:where(.astro-xwgiixxa).primary:hover{color:var(--sl-color-black)}.sl-link-button:where(.astro-xwgiixxa).secondary{border-color:inherit;color:var(--sl-color-white)}.sl-link-button:where(.astro-xwgiixxa).minimal{color:var(--sl-color-white);padding-inline:0}.sl-link-button:where(.astro-xwgiixxa) svg{flex-shrink:0}@media(min-width:50rem){.sl-link-button:where(.astro-xwgiixxa){font-size:var(--sl-text-base);padding:.9375rem 1.25rem}}.sl-markdown-content .sl-link-button:where(.astro-xwgiixxa){margin-inline-end:1rem}.sl-markdown-content .sl-link-button:where(.astro-xwgiixxa):not(:where(p *)){margin-block:1rem}}
</style><script type="module" src="/js/page-B1D-nYk3.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header astro-kmkmnagf"> <div class="title-wrapper sl-flex astro-kmkmnagf"> <a href="/" class="site-title sl-flex astro-m46x6ez3">  <img class="astro-m46x6ez3" alt src="/static/diesel_logo_favicon-BcNj_PV4.png" width="192" height="192">  <span class="astro-m46x6ez3" translate="no"> DIESEL </span> </a>  </div> <div class="sl-flex print:hidden astro-kmkmnagf"> <site-search class="astro-kmkmnagf astro-v37mnknz" data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}"> <button data-open-modal disabled aria-label="Search" aria-keyshortcuts="Control+K" class="astro-v37mnknz"> <svg aria-hidden="true" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg> <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <kbd class="sl-hidden md:sl-flex astro-v37mnknz" style="display: none;"> <kbd class="astro-v37mnknz">Ctrl</kbd><kbd class="astro-v37mnknz">K</kbd> </kbd> </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>  <script>
	(() => {
		const openBtn = document.querySelector('button[data-open-modal]');
		const shortcut = openBtn?.querySelector('kbd');
		if (!openBtn || !(shortcut instanceof HTMLElement)) return;
		const platformKey = shortcut.querySelector('kbd');
		if (platformKey && /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)) {
			platformKey.textContent = '⌘';
			openBtn.setAttribute('aria-keyshortcuts', 'Meta+K');
		}
		shortcut.style.display = '';
	})();
</script> <script type="module" src="/js/Search.astro_astro_type_script_index_0_lang-Dp1XlN9m.js"></script>   </div> <div class="sl-hidden md:sl-flex print:hidden right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <div class="header-links"> <a href="/news">News</a> <a href="/guides">Guides</a> <a href="/api_docs">API Docs</a> <a href="/changelog">Changelog</a> </div> <a href="https://github.com/diesel-rs/diesel" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> <select autocomplete="off" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script> <script type="module">const r="starlight-theme",o=e=>e==="auto"||e==="dark"||e==="light"?e:"auto",c=()=>o(typeof localStorage<"u"&&localStorage.getItem(r));function n(e){typeof localStorage<"u"&&localStorage.setItem(r,e==="light"||e==="dark"?e:"")}const l=()=>matchMedia("(prefers-color-scheme: light)").matches?"light":"dark";function t(e){StarlightThemeProvider.updatePickers(e),document.documentElement.dataset.theme=e==="auto"?l():e,n(e)}matchMedia("(prefers-color-scheme: light)").addEventListener("change",()=>{c()==="auto"&&t("auto")});class s extends HTMLElement{constructor(){super(),t(c()),this.querySelector("select")?.addEventListener("change",a=>{a.currentTarget instanceof HTMLSelectElement&&t(o(a.currentTarget.value))})}}customElements.define("starlight-theme-select",s);</script> <script type="module">class s extends HTMLElement{constructor(){super();const e=this.querySelector("select");e&&(e.addEventListener("change",t=>{t.currentTarget instanceof HTMLSelectElement&&(window.location.pathname=t.currentTarget.value)}),window.addEventListener("pageshow",t=>{if(!t.persisted)return;const n=e.querySelector("option[selected]")?.index;n!==e.selectedIndex&&(e.selectedIndex=n??0)}))}}customElements.define("starlight-lang-select",s);</script> </div> </div> </header> <nav class="sidebar print:hidden astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="print:hidden astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="open-menu astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg> <svg aria-hidden="true" class="close-menu astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="m13.41 12 6.3-6.29a1.004 1.004 0 1 0-1.42-1.42L12 10.59l-6.29-6.3a1.004 1.004 0 0 0-1.42 1.42l6.3 6.29-6.3 6.29a1 1 0 0 0 0 1.42.998.998 0 0 0 1.42 0l6.29-6.3 6.29 6.3a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.42L13.41 12Z"/></svg> </button> </starlight-menu-button> <script type="module">class s extends HTMLElement{constructor(){super(),this.btn=this.querySelector("button"),this.btn.addEventListener("click",()=>this.toggleExpanded());const t=this.closest("nav");t&&t.addEventListener("keyup",e=>this.closeOnEscape(e))}setExpanded(t){this.setAttribute("aria-expanded",String(t)),document.body.toggleAttribute("data-mobile-menu-expanded",t)}toggleExpanded(){this.setExpanded(this.getAttribute("aria-expanded")!=="true")}closeOnEscape(t){t.code==="Escape"&&(this.setExpanded(!1),this.btn.focus())}}customElements.define("starlight-menu-button",s);</script>   <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <sl-sidebar-state-persist data-hash="1bz4ry6" class="astro-kku4brbg"> <script aria-hidden="true">
		(() => {
			try {
				if (!matchMedia('(min-width: 50em)').matches) return;
				/** @type {HTMLElement | null} */
				const target = document.querySelector('sl-sidebar-state-persist');
				const state = JSON.parse(sessionStorage.getItem('sl-sidebar-state') || '0');
				if (!target || !state || target.dataset.hash !== state.hash) return;
				window._starlightScrollRestore = state.scroll;
				customElements.define(
					'sl-sidebar-restore',
					class SidebarRestore extends HTMLElement {
						connectedCallback() {
							try {
								const idx = parseInt(this.dataset.index || '');
								const details = this.closest('details');
								if (details && typeof state.open[idx] === 'boolean') details.open = state.open[idx];
							} catch {}
						}
					}
				);
			} catch {}
		})();
	</script>  <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Guides to Diesel</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="0"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/guides/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Overview</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/guides/getting-started/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Getting Started</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/guides/all-about-selects/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">All About Selects</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/guides/all-about-updates/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">All About Updates</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/guides/all-about-inserts/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">All About Inserts</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/guides/relations/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Relations</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/guides/composing-applications/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Composing Applications with Diesel</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/guides/schema-in-depth/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Schema in Depth</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/guides/extending-diesel/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Extending Diesel</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/guides/configuring-diesel-cli/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Configuring Diesel CLI</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/guides/migration-guide/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Diesel 2.0 migration guide</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">News</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="1"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/news/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">News</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/news/2_3_0_release" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Diesel 2.3.0</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/news/2_2_0_release" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Diesel 2.2.0</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/news/2_1_0_release" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Diesel 2.1.0</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/news/2_0_0_release" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Diesel 2.0.0</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">API Docs</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="2"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/api_docs/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">API Documentation</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/changelog/" aria-current="false" class="large astro-3ii7xxms"> <span class="astro-3ii7xxms">Changelog</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Compare Diesel</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="3"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/compare/compare_diesel/" aria-current="false" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Compare Diesel</span>  </a> </li> </ul>  </details> </li> </ul>   <script aria-hidden="true">
		(() => {
			const scroller = document.getElementById('starlight__sidebar');
			if (!window._starlightScrollRestore || !scroller) return;
			scroller.scrollTop = window._starlightScrollRestore;
			delete window._starlightScrollRestore;
		})();
	</script> </sl-sidebar-state-persist>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="social-icons astro-wu23bvmt"> <div class="header-links"> <a href="/news">News</a> <a href="/guides">Guides</a> <a href="/api_docs">API Docs</a> <a href="/changelog">Changelog</a> </div> <a href="https://github.com/diesel-rs/diesel" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> <select autocomplete="off" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <script type="module">const a=document.getElementById("starlight__sidebar"),n=a?.querySelector("sl-sidebar-state-persist"),o="sl-sidebar-state",i=()=>{let t=[];const e=n?.dataset.hash||"";try{const s=sessionStorage.getItem(o),r=JSON.parse(s||"{}");Array.isArray(r.open)&&r.hash===e&&(t=r.open)}catch{}return{hash:e,open:t,scroll:a?.scrollTop||0}},c=t=>{try{sessionStorage.setItem(o,JSON.stringify(t))}catch{}},d=()=>c(i()),l=(t,e)=>{const s=i();s.open[e]=t,c(s)};n?.addEventListener("click",t=>{if(!(t.target instanceof Element))return;const e=t.target.closest("summary")?.closest("details");if(!e)return;const s=e.querySelector("sl-sidebar-restore"),r=parseInt(s?.dataset.index||"");isNaN(r)||l(!e.open,r)});addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&d()});addEventListener("pageHide",d);</script> <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container print:hidden astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <script type="module" src="/js/MobileTableOfContents.astro_astro_type_script_index_0_lang-DB-xG_M7.js"></script><script type="module" src="/js/TableOfContents.astro_astro_type_script_index_0_lang-CKWWgpjV.js"></script><div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><span class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></span><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#mutable-connections-required" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Mutable Connections required</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#derive-attributes" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Derive attributes</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#diesel_migration-rewrite" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">diesel_migration rewrite</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#changed-nullability-of-operators" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Changed nullability of operators</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#changed-nullability-of-array-elements" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Changed nullability of array elements</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#custom-sql-type-implementations" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Custom SQL type implementations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#changed-tosql-implementations" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Changed ToSql implementations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#changed-fromsql-implementations" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Changed FromSql implementations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#no_arg_sql_function" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">no_arg_sql_function</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#changed-accepted-argument-to-eq_any-for-the-postgresql-backend" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Changed accepted argument to eq_any() for the PostgreSQL backend </span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#replacement-of-nonaggregate-with-validgrouping" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Replacement of NonAggregate with ValidGrouping</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#other-changes-to-generics" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Other changes to generics</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#removed-most-of-the-non-public-reachable-api" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Removed most of the non-public reachable API</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#changed-structure-of-the-deserialization-traits" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Changed structure of the deserialization traits</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#changed-the-scope-of-queryfragment-implementations" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Changed the scope of QueryFragment implementations</span> </a>  </li> </ul>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#mutable-connections-required" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Mutable Connections required</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#derive-attributes" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Derive attributes</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#diesel_migration-rewrite" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">diesel_migration rewrite</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#changed-nullability-of-operators" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Changed nullability of operators</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#changed-nullability-of-array-elements" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Changed nullability of array elements</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#custom-sql-type-implementations" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Custom SQL type implementations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#changed-tosql-implementations" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Changed ToSql implementations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#changed-fromsql-implementations" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Changed FromSql implementations</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#no_arg_sql_function" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">no_arg_sql_function</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#changed-accepted-argument-to-eq_any-for-the-postgresql-backend" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Changed accepted argument to eq_any() for the PostgreSQL backend </span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#replacement-of-nonaggregate-with-validgrouping" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Replacement of NonAggregate with ValidGrouping</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#other-changes-to-generics" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Other changes to generics</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#removed-most-of-the-non-public-reachable-api" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Removed most of the non-public reachable API</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#changed-structure-of-the-deserialization-traits" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Changed structure of the deserialization traits</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#changed-the-scope-of-queryfragment-implementations" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Changed the scope of QueryFragment implementations</span> </a>  </li> </ul>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body class="astro-bguv2lll" lang="en" dir="ltr">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">Diesel 2.0 migration guide</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <p>Diesel 2.0 introduces substantial changes to Diesel’s inner workings.
In some cases this impacts code written using Diesel 1.4.x.
This document outlines notable changes and presents potential update strategies.
We recommend to start the upgrade by removing the usage of all items that
are marked as deprecated in Diesel 1.4.x.</p>
<p>Any code base migrating to Diesel 2.0 is expected to be affected at least by
the following changes:</p>
<ul>
<li><a href="#2-0-0-mutable-connection">Diesel now requires a mutable reference to the connection</a></li>
<li><a href="#2-0-0-derive-attributes">Changed derive attributes</a></li>
</ul>
<p>Users of <code dir="auto">diesel_migration</code> are additionally affected by the following change:</p>
<ul>
<li><a href="#2-0-0-upgrade-migrations"><code dir="auto">diesel_migration</code> rewrite</a></li>
</ul>
<p>Users of <code dir="auto">BoxableExpression</code> might be affected by the following change:</p>
<ul>
<li><a href="#2-0-0-nullability-ops">Changed nullability of operators</a></li>
</ul>
<p>Users of tables containing a column of the type <code dir="auto">Array&#x3C;T></code> are affected by the following change:</p>
<ul>
<li><a href="#2-0-0-nullability-of-array-elements">Changed nullability of array elements</a></li>
</ul>
<p>Users that implement support for their SQL types or type mappings are affected
by the following changes:</p>
<ul>
<li><a href="#2-0-0-custom-type-implementation">Changed required traits for custom SQL types</a></li>
<li><a href="#2-0-0-to-sql">Changed <code dir="auto">ToSql</code> implementations</a></li>
<li><a href="#2-0-0-from-sql">Changed <code dir="auto">FromSql</code> implementations</a></li>
</ul>
<p><code dir="auto">no_arg_sql_function!</code> macro is now pending deprecation.
Users of the macro are advised to consider <code dir="auto">sql_function!</code> macro.</p>
<ul>
<li><a href="#2-0-0-no_arg_sql_function">Deprecated usage of <code dir="auto">no_arg_sql_function!</code> macro</a></li>
</ul>
<p>Users of <code dir="auto">eq_any</code> on the PostgreSQL backend might hit type rejection error in rare cases.</p>
<ul>
<li><a href="#2-0-0-changed_eq_any">Changed accepted argument to <code dir="auto">eq_any()</code> for the PostgreSQL backend</a></li>
</ul>
<p>Users that update generic Diesel code will also be affected by the following changes:</p>
<ul>
<li><a href="#2-0-0-upgrade-non-aggregate">Removing <code dir="auto">NonAggregate</code> in favor of <code dir="auto">ValidGrouping</code></a></li>
<li><a href="#2-0-0-generic-changes">Changed generic bounds</a></li>
</ul>
<p>Additionally this release contains many changes for users that implemented a custom backend/connection.
We do not provide explicit migration steps but we encourage users to reach out with questions pertaining to these changes.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="mutable-connections-required">Mutable Connections required<a name="2-0-0-mutable-connection"></a></h2><a class="sl-anchor-link" href="#mutable-connections-required"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Mutable Connections required”</span></a></div>
<br>
<p>Diesel now requires mutable access to the <a href="http://docs.diesel.rs/2.0.x/diesel/connection/trait.Connection.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">Connection</code></a> to perform any database interaction. The following changes
are required for all usages of any <a href="http://docs.diesel.rs/2.0.x/diesel/connection/trait.Connection.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">Connection</code></a> type:</p>
<div class="expressive-code"><link rel="stylesheet" href="/static/ec.v4551.css"><script type="module" src="/static/ec.0vx5m.js"></script><figure class="frame has-title not-content"><figcaption class="header"><span class="title">Change</span></figcaption><pre data-language="diff"><code><div class="ec-line highlight del"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">let connection = PgConnection::establish_connection("…")?;</span></div></div><div class="ec-line highlight del"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">let result = some_query.load(&#x26;connection)?;</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">let mut connection = PgConnection::establish_connection("…")?;</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">let result = some_query.load(&#x26;mut connection)?;</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="let connection = PgConnection::establish_connection(&#x22;…&#x22;)?;let result = some_query.load(&#x26;connection)?;let mut connection = PgConnection::establish_connection(&#x22;…&#x22;)?;let result = some_query.load(&#x26;mut connection)?;"><div></div></button></div></figure></div>
<p>We expect this to be a straightforward change as the connection already can execute only one query at a time.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="derive-attributes">Derive attributes<a name="2-0-0-derive-attributes"></a></h2><a class="sl-anchor-link" href="#derive-attributes"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Derive attributes”</span></a></div>
<br>
<p>We have updated all of our Diesel derive attributes to follow the patterns that are used
widely in the Rust’s ecosystem. This means that all of them need to be wrapped by <code dir="auto">#[diesel()]</code> now.  You can now specify multiple attributes on the same line using <code dir="auto">,</code> separator.</p>
<p>This is backward compatible and thus all of your old attributes will still work, but with
warnings. The attributes can be upgraded by either looking at the warnings or by reading
diesel derive documentation reference.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="diesel_migration-rewrite"><code dir="auto">diesel_migration</code> rewrite<a name="2-0-0-upgrade-migrations"></a></h2><a class="sl-anchor-link" href="#diesel_migration-rewrite"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “diesel_migration rewrite”</span></a></div>
<br>
<p>We have completely rewritten the <code dir="auto">diesel_migration</code> crate. As a part of this rewrite all
free standing functions are removed from <code dir="auto">diesel_migration</code>. Equivalent functionality
is now provided by the <a href="http://docs.diesel.rs/2.0.x/diesel_migrations/trait.MigrationHarness.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">MigrationHarness</code></a> trait, which is implemented for any <a href="http://docs.diesel.rs/2.0.x/diesel/connection/trait.Connection.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">Connection</code> </a>
type and for <a href="http://docs.diesel.rs/2.0.x/diesel_migrations/struct.HarnessWithOutput.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">HarnessWithOutput</code></a>. Refer to their documentations for details.</p>
<p>Additionally, this rewrite changed the way we provide migrations. Instead of having our own implementation
for file based and embedded migration we now provide a unified <a href="http://docs.diesel.rs/2.0.x/diesel/migration/trait.MigrationSource.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">MigrationSource</code></a> trait to abstract
over the differences. <code dir="auto">diesel_migration</code> provides two implementations:</p>
<ul>
<li><a href="http://docs.diesel.rs/2.0.x/diesel_migrations/struct.FileBasedMigrations.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">FileBasedMigrations</code></a>, which mirrors the existing behaviour to load raw sql migrations at run time
form a specific directory</li>
<li><a href="http://docs.diesel.rs/2.0.x/diesel_migrations/struct.EmbeddedMigrations.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">EmbeddedMigrations</code></a>, which mirrors the existing <a href="http://docs.diesel.rs/2.0.x/diesel_migrations/macro.embed_migrations.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">embed_migrations!()</code></a> macro.</li>
</ul>
<p>Finally the <a href="http://docs.diesel.rs/2.0.x/diesel_migrations/macro.embed_migrations.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">embed_migrations!()</code></a> macro itself changed. Instead of generating a magical embedded module
it now generates an instance of <a href="http://docs.diesel.rs/2.0.x/diesel_migrations/struct.EmbeddedMigrations.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">EmbeddedMigrations</code></a>, that could be stored in a constant for example.</p>
<p>That means code using <a href="http://docs.diesel.rs/2.0.x/diesel_migrations/macro.embed_migrations.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">embed_migrations!()</code></a> needs to be changed from</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">Change</span></figcaption><pre data-language="rust"><code><div class="ec-line"><div class="code"><span style="--0:#82AAFF;--1:#3B61B0">embed_migrations!</span><span style="--0:#D6DEEB;--1:#403F53">()</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">fn</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">run_migration</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C5E478;--1:#3B61B0">conn</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">&#x26;</span><span style="--0:#D6DEEB;--1:#403F53">PgConnection) {</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">embedded_migrations</span><span style="--0:#7FDBCA;--1:#096E72">::</span><span style="--0:#82AAFF;--1:#3B61B0">run</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C5E478;--1:#3B61B0">conn</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#82AAFF;--1:#3B61B0">unwrap</span><span style="--0:#D6DEEB;--1:#403F53">()</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="embed_migrations!()fn run_migration(conn: &#x26;PgConnection) {    embedded_migrations::run(conn).unwrap()}"><div></div></button></div></figure></div>
<p>to</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">Change</span></figcaption><pre data-language="rust"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">pub</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C792EA;--1:#8844AE">const</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">MIGRATIONS</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#D6DEEB;--1:#403F53"> EmbeddedMigrations </span><span style="--0:#C792EA;--1:#8844AE">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">embed_migrations!</span><span style="--0:#D6DEEB;--1:#403F53">();</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">fn</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">run_migration</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#C5E478;--1:#3B61B0">conn</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">&#x26;</span><span style="--0:#C792EA;--1:#8844AE">mut</span><span style="--0:#D6DEEB;--1:#403F53"> PgConnection) {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">conn</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#82AAFF;--1:#3B61B0">run_pending_migrations</span><span style="--0:#D6DEEB;--1:#403F53">(</span><span style="--0:#82AAFF;--1:#3B61B0">MIGRATIONS</span><span style="--0:#D6DEEB;--1:#403F53">)</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#82AAFF;--1:#3B61B0">unwrap</span><span style="--0:#D6DEEB;--1:#403F53">();</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="pub const MIGRATIONS: EmbeddedMigrations = embed_migrations!();fn run_migration(conn: &#x26;mut PgConnection) {    conn.run_pending_migrations(MIGRATIONS).unwrap();}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h2"><h2 id="changed-nullability-of-operators">Changed nullability of operators<a name="2-0-0-nullability-ops"></a></h2><a class="sl-anchor-link" href="#changed-nullability-of-operators"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed nullability of operators”</span></a></div>
<br>
<p>We changed the way how we handle the propagation of null values through binary operators. Diesel 1.x always assumed
that the result of a binary operation <code dir="auto">value_a > value_b</code> is not nullable, which does not match the behaviour of the
underlying databases. <code dir="auto">value_a > null</code> may return a <code dir="auto">NULL</code> value there. With Diesel 2.0 we changed this to match more
closely the behaviour of the underlying databases. We expect this change to have the biggest impact on existing usages
of <code dir="auto">BoxableExpression</code> as it may change the resulting sql type there. As a possible workaround for divering sql types
there we recommend to use one of the following functions:</p>
<ul>
<li><a href="http://docs.diesel.rs/2.0.x/diesel/expression_methods/trait.NullableExpressionMethods.html#method.nullable" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">NullableExpressionMethods::nullable()</code></a></li>
<li><a href="http://docs.diesel.rs/2.0.x/diesel/expression_methods/trait.NullableExpressionMethods.html#method.assume_not_null" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">NullableExpressionMethods::assume_not_null()</code></a></li>
</ul>
<div class="sl-heading-wrapper level-h2"><h2 id="changed-nullability-of-array-elements">Changed nullability of array elements<a name="2-0-0-nullability-of-array-elements"></a></h2><a class="sl-anchor-link" href="#changed-nullability-of-array-elements"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed nullability of array elements”</span></a></div>
<br>
<p>We changed the inferred SQL type for columns with array types for the PostgreSQL backend. Instead of using <code dir="auto">Array&#x3C;ST></code>
we now infer <code dir="auto">Array&#x3C;Nullable&#x3C;ST>></code> to support arrays containing <code dir="auto">NULL</code> values. This change implies a change mapping
of columns of the corresponding types. It is possible to handle this change using one of the following strategies:</p>
<ul>
<li>Use <code dir="auto">Vec&#x3C;Option&#x3C;T>></code> as rust side type instead of <code dir="auto">Vec&#x3C;T></code></li>
<li>Manually set the corresponding column to <code dir="auto">Array&#x3C;ST></code> in your schema, to signal that this array does not contain null values. You may want to use the <a href="./configuring-diesel-cli.html"><code dir="auto">patch_file</code></a> key for diesel CLI for this.</li>
<li>Use [<code dir="auto">#[diesel(deserialize_as = "…")]</code>] to explicitly overwrite the  deserialization implementation used for this specific struct field. Checkout the documentation of [<code dir="auto">#[derive(Queryable)]</code>] for details.</li>
</ul>
<p>[<code dir="auto">#[diesel(deserialize_as = "…")]</code>]: <a href="http://docs.diesel.rs/2.0.x/diesel/deserialize/derive.Queryable.html#optional-field-attributes" rel="nofollow noopener noreferrer" target="_blank">http://docs.diesel.rs/2.0.x/diesel/deserialize/derive.Queryable.html#optional-field-attributes</a>
[<code dir="auto">#[derive(Queryable)]</code>]: <a href="http://docs.diesel.rs/2.0.x/diesel/deserialize/derive.Queryable.html" rel="nofollow noopener noreferrer" target="_blank">http://docs.diesel.rs/2.0.x/diesel/deserialize/derive.Queryable.html</a></p>
<div class="sl-heading-wrapper level-h2"><h2 id="custom-sql-type-implementations">Custom SQL type implementations<a name="2-0-0-custom-type-implementation"></a></h2><a class="sl-anchor-link" href="#custom-sql-type-implementations"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Custom SQL type implementations”</span></a></div>
<br>
<p>We changed how we mark sql types as nullable at type level. For this we replaced the <code dir="auto">NonNull</code> trait with a
more generic <a href="http://docs.diesel.rs/2.0.x/diesel/sql_types/trait.SqlType.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">SqlType</code></a> trait, which allows to mark a sql type as (non-) nullable. This may affect custom
sql type implementations.</p>
<p>Users that already use the existing [<code dir="auto">#[derive(SqlType)]</code>] do not need to change any code. The derive internally
generates the correct code after the update. Users that use a manual implementation of <code dir="auto">NonNull</code> need to replace
it with a corresponding <a href="http://docs.diesel.rs/2.0.x/diesel/sql_types/trait.SqlType.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">SqlType</code></a> implementation:</p>
<p>[<code dir="auto">#[derive(SqlType)]</code>]: <a href="http://docs.diesel.rs/2.0.x/diesel/sql_types/derive.SqlType.html" rel="nofollow noopener noreferrer" target="_blank">http://docs.diesel.rs/2.0.x/diesel/sql_types/derive.SqlType.html</a></p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">Change</span></figcaption><pre data-language="diff"><code><div class="ec-line highlight del"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">impl NonNull for MyCustomSqlType {}</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">impl SqlType for MyCustomSqlType {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">type IsNull = diesel::sql_types::is_nullable::NotNull;</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="impl NonNull for MyCustomSqlType {}impl SqlType for MyCustomSqlType {    type IsNull = diesel::sql_types::is_nullable::NotNull;}"><div></div></button></div></figure></div>
<p>Additionally, the diesel CLI tool was changed so that it automatically generates the Rust side definition of custom SQL types
as long as they appear on any table. This feature currently only supports the PostgreSQL backend, as all other supported backends
do not support real custom types at SQL level at all.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="changed-tosql-implementations">Changed <code dir="auto">ToSql</code> implementations<a name="2-0-0-to-sql"></a></h2><a class="sl-anchor-link" href="#changed-tosql-implementations"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed ToSql implementations”</span></a></div>
<br>
<p>We restructured the way Diesel serializes Rust values to their backend specific representation.
This enables us to skip copying the value at all if the specific backend supports writing to a
shared buffer. Unfortunately, this feature requires changes to the <a href="http://docs.diesel.rs/2.0.x/diesel/serialize/trait.ToSql.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">ToSql</code></a> trait. This change introduces
a lifetime that ensures that a value implementing <a href="http://docs.diesel.rs/2.0.x/diesel/serialize/trait.ToSql.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">ToSql</code></a> outlives the underlying serialisation buffer.
Additionally we separated the output buffer type for Sqlite from the type used for PostgreSQL and Mysql.</p>
<p>This has the implication that for generic implementations using a inner existing <a href="http://docs.diesel.rs/2.0.x/diesel/serialize/trait.ToSql.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">ToSql</code></a> implementation you cannot
create temporary values anymore and forward them to the inner implementation.</p>
<p>For backend concrete implementations, the following functions allow You to work around this limitation:</p>
<ul>
<li><a href="http://docs.diesel.rs/2.0.x/diesel/serialize/struct.Output.html#method.reborrow" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">Output::reborrow()</code></a> for the <code dir="auto">Pg</code> and <code dir="auto">Mysql</code> backend</li>
<li><a href="http://docs.diesel.rs/2.0.x/diesel/serialize/struct.Output.html#method.set_value" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">Output::set_value()</code></a> for the <code dir="auto">Sqlite</code> backend (Refer to the documentation of <a href="http://docs.diesel.rs/2.0.x/diesel/sqlite/struct.SqliteBindValue.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">SqliteBindValue</code></a> for accepted values)</li>
</ul>
<div class="sl-heading-wrapper level-h2"><h2 id="changed-fromsql-implementations">Changed <code dir="auto">FromSql</code> implementations<a name="2-0-0-from-sql"></a></h2><a class="sl-anchor-link" href="#changed-fromsql-implementations"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed FromSql implementations”</span></a></div>
<br>
<p>We changed the raw value representation for both PostgreSQL and MySQL
backends, from a <code dir="auto">&#x26;[u8]</code> to an opaque type. This allows us to include additional information like the database side
type there. This change enables users to write <a href="http://docs.diesel.rs/2.0.x/diesel/deserialize/trait.FromSql.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">FromSql</code></a> implementations that decide dynamically what kind of value
was received. The new value types for both backends expose a <code dir="auto">as_bytes()</code> method to access the underlying byte buffer.</p>
<p>Any affected backend needs to perform the following changes:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">Change</span></figcaption><pre data-language="diff"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">impl&#x3C;DB: Backend> FromSql&#x3C;YourSqlType, DB> for YourType {</span></div></div><div class="ec-line highlight del"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">fn from_sql(bytes: &#x26;[u8]) -> deserialize::Result&#x3C;Self> {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">fn from_sql(value: backend::RawValue&#x3C;'_, DB>) -> deserialize::Result&#x3C;Self> {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">let bytes = value.as_bytes();</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">         </span></span><span style="--0:#D6DEEB;--1:#403F53">// …</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">     </span></span><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="impl<DB: Backend> FromSql<YourSqlType, DB> for YourType {    fn from_sql(bytes: &#x26;[u8]) -> deserialize::Result<Self> {    fn from_sql(value: backend::RawValue<&#x27;_, DB>) -> deserialize::Result<Self> {        let bytes = value.as_bytes();         // …     }}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h2"><h2 id="no_arg_sql_function"><code dir="auto">no_arg_sql_function</code><a name="2-0-0-no_arg_sql_function"></a></h2><a class="sl-anchor-link" href="#no_arg_sql_function"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “no_arg_sql_function”</span></a></div>
<br>
<p>The <a href="http://docs.diesel.rs/2.0.x/diesel/macro.no_arg_sql_function.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">no_arg_sql_function!</code></a> was deprecated without direct replacement. At the same time the
<a href="http://docs.diesel.rs/2.0.x/diesel/expression/functions/macro.sql_function.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">sql_function!</code></a> macro gained support for sql functions without argument. This support generates slightly
different code. Instead of representing the sql function as zero sized struct, <a href="http://docs.diesel.rs/2.0.x/diesel/expression/functions/macro.sql_function.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">sql_function!</code></a> will generate an ordinary function call without arguments. This requires changing any usage of the generated dsl. This change
affects all of the usages of the <a href="http://docs.diesel.rs/2.0.x/diesel/macro.no_arg_sql_function.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">no_arg_sql_function!</code></a> in third party crates.</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">Change</span></figcaption><pre data-language="diff"><code><div class="ec-line highlight del"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">no_arg_sql_function!(now, sql_types::Timestamp, "Represents the SQL NOW() function");</span></div></div><div class="ec-line highlight del"><div class="code">
</div></div><div class="ec-line highlight del"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">diesel::select(now)</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">sql_function!{</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">/// Represents the SQL NOW() function</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">fn now() -> sql_types::Timestamp;</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line highlight ins"><div class="code">
</div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">diesel::select(now())</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="no_arg_sql_function!(now, sql_types::Timestamp, &#x22;Represents the SQL NOW() function&#x22;);diesel::select(now)sql_function!{    /// Represents the SQL NOW() function    fn now() -> sql_types::Timestamp;}diesel::select(now())"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h2"><h2 id="changed-accepted-argument-to-eq_any-for-the-postgresql-backend">Changed accepted argument to <code dir="auto">eq_any()</code> for the PostgreSQL backend <a name="2-0-0-changed_eq_any"></a></h2><a class="sl-anchor-link" href="#changed-accepted-argument-to-eq_any-for-the-postgresql-backend"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed accepted argument to eq_any() for the PostgreSQL backend ”</span></a></div>
<br>
<p>Diesel 2.0 introduces an optimisation that replaces the <code dir="auto">IN($1, ..., $n)</code> expression generated previously by <code dir="auto">.eq_any()</code> with the more optimised <code dir="auto">= ANY($1)</code> which binds the parameter as single array instead of binding each element separately. This improves the performance of large lists and allows us to keep such queries in the prepared statement cache, which enables future performance improvements. Unfortunately not all previously accepted arguments are accepted now. Newly rejected cases include:</p>
<ul>
<li>A list of arrays where the <code dir="auto">values</code> variable in <code dir="auto">col.eq_any(values)</code> has the type <code dir="auto">Vec&#x3C;Vec&#x3C;T>></code></li>
<li>Using <code dir="auto">.eq_any()</code> on several columns at one via <code dir="auto">(table::col_a, table_col::b).eq_any(values)</code></li>
</ul>
<p>Both cases can be worked around by using boxed queries and repeated chained equality checks.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="replacement-of-nonaggregate-with-validgrouping">Replacement of <code dir="auto">NonAggregate</code> with <code dir="auto">ValidGrouping</code><a name="2-0-0-upgrade-non-aggregate"></a></h2><a class="sl-anchor-link" href="#replacement-of-nonaggregate-with-validgrouping"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Replacement of NonAggregate with ValidGrouping”</span></a></div>
<br>
<p>Diesel now fully enforces the aggregation rules, which required us to change the way we represent the aggregation
at the type system level. This is used to provide <code dir="auto">group_by</code> support. Diesel’s aggregation rules
match the semantics of PostgreSQL or MySQL with the <code dir="auto">ONLY_FULL_GROUP_BY</code> option enabled.</p>
<p>As part of this change we removed the <code dir="auto">NonAggregate</code> trait in favor of a new, more expressive <a href="http://docs.diesel.rs/2.0.x/diesel/expression/trait.ValidGrouping.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">ValidGrouping</code></a>
trait. Existing implementations of <code dir="auto">NonAggregate</code> must be replaced with an equivalent <a href="http://docs.diesel.rs/2.0.x/diesel/expression/trait.ValidGrouping.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">ValidGrouping</code></a> implementation.</p>
<p>The following change shows how to replace an existing implementation with a strictly equivalent implementation.</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">Change</span></figcaption><pre data-language="diff"><code><div class="ec-line highlight del"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">impl NonAggregate for MyQueryNode {}</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">impl ValidGrouping&#x3C;()> for MyQueryNode {</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">   </span></span><span style="--0:#D6DEEB;--1:#403F53">type IsAggregate = is_aggregate::No;</span></div></div><div class="ec-line highlight ins"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="impl NonAggregate for MyQueryNode {}impl ValidGrouping<()> for MyQueryNode {   type IsAggregate = is_aggregate::No;}"><div></div></button></div></figure></div>
<p>Additional changes may be required to adapt custom query ast implementations to fully support <code dir="auto">group_by</code> clauses.
Refer to the documentation of <a href="http://docs.diesel.rs/2.0.x/diesel/expression/trait.ValidGrouping.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">ValidGrouping</code></a> for details.</p>
<p>In addition, any occurrence of <code dir="auto">NonAggregate</code> in trait bounds needs to be replaced. Again, the following
change shows the strictly equivalent version:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">Change</span></figcaption><pre data-language="diff"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">where</span></div></div><div class="ec-line highlight del"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">     </span></span><span style="--0:#D6DEEB;--1:#403F53">T: NonAggregate,</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">     </span></span><span style="--0:#D6DEEB;--1:#403F53">T: ValidGrouping&#x3C;()>,</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">     </span></span><span style="--0:#D6DEEB;--1:#403F53">T::IsAggregate: MixedGrouping&#x3C;is_aggregate::No, Output = is_aggregate::No>,</span></div></div><div class="ec-line highlight ins"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">     </span></span><span style="--0:#D6DEEB;--1:#403F53">is_aggregate::No: MixedGrouping&#x3C;T::IsAggregate, Output = is_aggregate::No>,</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="where     T: NonAggregate,     T: ValidGrouping<()>,     T::IsAggregate: MixedGrouping<is_aggregate::No, Output = is_aggregate::No>,     is_aggregate::No: MixedGrouping<T::IsAggregate, Output = is_aggregate::No>,"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h2"><h2 id="other-changes-to-generics">Other changes to generics<a name="2-0-0-generic-changes"></a></h2><a class="sl-anchor-link" href="#other-changes-to-generics"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Other changes to generics”</span></a></div>
<br>
<p>In addition to the changes listed above, we changed numerous internal details of Diesel. This will have impact on
most codebases that include non-trivial generic code abstracting over Diesel. This section tries to list as much of those
changes as possible</p>
<div class="sl-heading-wrapper level-h3"><h3 id="removed-most-of-the-non-public-reachable-api">Removed most of the non-public reachable API</h3><a class="sl-anchor-link" href="#removed-most-of-the-non-public-reachable-api"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Removed most of the non-public reachable API”</span></a></div>
<br>
<p>With Diesel 2.0 we removed most of the API which was marked with <code dir="auto">#[doc(hidden)]</code>. Technically these parts of the API
have always been private to Diesel. This change enforces this distinction in stricter way. In addition, some
parts of these formerly hidden API are now documented and exposed behind the
<code dir="auto">i-implement-a-third-party-backend-and-opt-into-breaking-changes</code> crate feature. As the name already implies
we reserve the right to change these APIs between different Diesel 2.x minor releases, so you should always pin
a concrete minor release version if you use these APIs.
If you depended on such an API and you cannot find a suitable replacement we invite you to work with us on exposing the corresponding
feature as part of the stable API.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="changed-structure-of-the-deserialization-traits">Changed structure of the deserialization traits</h3><a class="sl-anchor-link" href="#changed-structure-of-the-deserialization-traits"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed structure of the deserialization traits”</span></a></div>
<br>
<p>We changed the internal structure of the <a href="http://docs.diesel.rs/2.0.x/diesel/deserialize/trait.FromSqlRow.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">FromSqlRow</code></a>, <a href="http://docs.diesel.rs/2.0.x/diesel/prelude/trait.Queryable.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">Queryable</code></a> and <a href="http://docs.diesel.rs/2.0.x/diesel/prelude/trait.QueryableByName.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">QueryableByName</code></a> trait family used for deserialization. This change allows us to unify our deserialization code.
We hopefully put sufficient wild card implementations in place so that old trait bounds imply
the right trait anyway. For cases where this does not hold true, the following changes may be required:</p>
<p><code dir="auto">Queryable&#x3C;ST, DB></code> is now equivalent to <code dir="auto">FromSqlRow&#x3C;ST, DB></code>. The latter is used as an actual trait bound
on the corresponding [<code dir="auto">RunQueryDsl</code>] methods.
<code dir="auto">QueryableByName&#x3C;DB></code> is now equivalent to <code dir="auto">FromSqlRow&#x3C;Untyped, DB></code>. The latter is used as an actual trait
on the corresponding [<code dir="auto">RunQueryDsl</code>] methods.</p>
<div class="sl-heading-wrapper level-h3"><h3 id="changed-the-scope-of-queryfragment-implementations">Changed the scope of <code dir="auto">QueryFragment</code> implementations</h3><a class="sl-anchor-link" href="#changed-the-scope-of-queryfragment-implementations"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only">Section titled “Changed the scope of QueryFragment implementations”</span></a></div>
<br>
<p>With Diesel 2.0, we introduced a way to specialise <a href="http://docs.diesel.rs/2.0.x/diesel/query_builder/trait.QueryFragment.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">QueryFragment</code></a> implementations for specific backend, while
providing a generic implementation for other backends. To be able to use this feature in the future we marked
existing wild card <a href="http://docs.diesel.rs/2.0.x/diesel/query_builder/trait.QueryFragment.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">QueryFragment</code></a> implementations with an additional <a href="http://docs.diesel.rs/2.0.x/diesel/backend/trait.DieselReserveSpecialization.html" rel="nofollow noopener noreferrer" target="_blank"><code dir="auto">DieselReserveSpecialization</code></a>.
Rustc suggests just adding an additional trait bound on this trait. It’s not possible to add a bound on
this trait without opting into breaking changes and it’s almost never required to actually do that. Any
occurrence of an error mentioning this trait can simply be fixed by adding a trait bound like follows:</p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">Change</span></figcaption><pre data-language="rust"><code><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">where</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">QueryAstNodeMentionedInTheErrorMessage</span><span style="--0:#7FDBCA;--1:#096E72">:</span><span style="--0:#D6DEEB;--1:#403F53"> QueryFragment&#x3C;BackendType></span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="where    QueryAstNodeMentionedInTheErrorMessage: QueryFragment<BackendType>"><div></div></button></div></figure></div>
<p>This rule has one notable exception: Third party backend implementations. We expect those backends to opt into the
<code dir="auto">i-implement-a-third-party-backend-and-opt-into-breaking-changes</code> feature anyway, as it’s otherwise not possible to
implement a third party backend.</p> </div> <footer class="sl-flex astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links print:hidden astro-u2l5gyhi" dir="ltr"> <a href="/guides/configuring-diesel-cli/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg> <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Configuring Diesel CLI</span> </span> </a> <a href="/news/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg> <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">News</span> </span> </a> </div>   </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>